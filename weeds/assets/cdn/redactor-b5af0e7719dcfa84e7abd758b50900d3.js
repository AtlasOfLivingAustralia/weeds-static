/*
	Redactor v8.0.2
	Updated: August 18, 2012

	http://redactorjs.com/

	Copyright (c) 2009-2012, Imperavi Inc.
	License: http://redactorjs.com/license/

	Usage: $('#content').redactor();
*/
function invokeRedactor(t,e,i){switch(t="class"==i?"."+t:"#"+t,e){case"ticket":jQuery(t).redactor({focus:!1,convertDivs:!1,observeImages:!0,autoresize:!1,imageUpload:"/tickets_uploaded_images",clipboardImageUpload:"/tickets_uploaded_images/create_file",setFontSettings:!0,wrapFontSettings:Helpdesk.settings,allowTagsInCodeSnippet:!0,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link","image","removeFormat"],imageUploadCallback:inlineImageUploadCallback});break;case"template":jQuery(t).redactor({focus:!1,convertDivs:!1,observeImages:!0,autoresize:!1,imageUpload:"/ticket_templates_uploaded_images",clipboardImageUpload:"/ticket_templates_uploaded_images/create_file",setFontSettings:!0,wrapFontSettings:Helpdesk.settings,allowTagsInCodeSnippet:!0,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link","image","removeFormat"]});break;case"forum":jQuery(t).redactor({autoresize:!1,convertDivs:!1,allowTagsInCodeSnippet:!0,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link","image","video"],imageUpload:"/forums_uploaded_images",clipboardImageUpload:"/forums_uploaded_images/create_file",imageGetJson:"/forums_uploaded_images",imageUploadCallback:inlineImageUploadCallback});break;case"solution":jQuery(t).redactor({autoresize:!0,convertDivs:!1,allowTagsInCodeSnippet:!0,tabindex:2,imageUpload:"/solutions_uploaded_images",clipboardImageUpload:"/solutions_uploaded_images/create_file",imageGetJson:"/solutions_uploaded_images"});break;case"cnt-reply":jQuery(t).redactor({focus:!0,convertDivs:!1,autoresize:!1,observeImages:!0,imageUpload:"/tickets_uploaded_images",clipboardImageUpload:"/tickets_uploaded_images/create_file",setFontSettings:!0,wrapFontSettings:Helpdesk.settings,allowTagsInCodeSnippet:!0,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link","image","removeFormat"],execCommandCallback:function(t,e){"undefined"!=typeof TICKET_DETAILS_DATA?"undefined"!=typeof TICKET_DETAILS_DATA.draft.clearingDraft&&TICKET_DETAILS_DATA.draft.clearingDraft?TICKET_DETAILS_DATA.draft.clearingDraft=!1:TICKET_DETAILS_DATA.draft.hasChanged=!0:isDirty=!0},keyupCallback:function(t,e){"undefined"!=typeof TICKET_DETAILS_DATA?"undefined"!=typeof TICKET_DETAILS_DATA.draft.clearingDraft&&TICKET_DETAILS_DATA.draft.clearingDraft?TICKET_DETAILS_DATA.draft.clearingDraft=!1:(isDirty=!0,TICKET_DETAILS_DATA.draft.hasChanged=!0):isDirty=!0},imageUploadCallback:inlineImageUploadCallback});case"cnt-fwd":jQuery(t).redactor({focus:!1,convertDivs:!1,observeImages:!0,autoresize:!1,imageUpload:"/tickets_uploaded_images",clipboardImageUpload:"/tickets_uploaded_images/create_file",setFontSettings:!0,wrapFontSettings:Helpdesk.settings,allowTagsInCodeSnippet:!0,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link","image","removeFormat"],imageUploadCallback:inlineImageUploadCallback});break;case"automation":jQuery(t).redactor({focus:!1,convertDivs:!1,observeImages:!0,autoresize:!1,imageUpload:"/tickets_uploaded_images",clipboardImageUpload:"/tickets_uploaded_images/create_file",setFontSettings:!0,wrapFontSettings:Helpdesk.settings,allowTagsInCodeSnippet:!0,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link","image","removeFormat"]});break;case"cnt-note":jQuery(t).redactor({focus:!0,convertDivs:!1,observeImages:!0,autoresize:!1,imageUpload:"/tickets_uploaded_images",clipboardImageUpload:"/tickets_uploaded_images/create_file",setFontSettings:!0,wrapFontSettings:Helpdesk.settings,allowTagsInCodeSnippet:!0,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link","image","removeFormat"],imageUploadCallback:inlineImageUploadCallback});break;case"cnt-broadcast":jQuery(t).redactor({focus:!0,convertDivs:!1,observeImages:!0,autoresize:!1,imageUpload:"/tickets_uploaded_images",clipboardImageUpload:"/tickets_uploaded_images/create_file",setFontSettings:!0,wrapFontSettings:Helpdesk.settings,allowTagsInCodeSnippet:!0,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link","image","removeFormat"],imageUploadCallback:inlineImageUploadCallback});break;case"bulk-reply":jQuery(t).redactor({focus:!1,convertDivs:!1,observeImages:!0,autoresize:!1,imageUpload:"/tickets_uploaded_images",setFontSettings:!0,wrapFontSettings:Helpdesk.settings,allowTagsInCodeSnippet:!0,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link","image","removeFormat"],imageUploadCallback:inlineImageUploadCallback});break;case"signature":jQuery(t).redactor({focus:!1,convertDivs:!1,autoresize:!1,buttons:["bold","italic","underline","|","image","|","fontcolor","backcolor","|","link"]});default:jQuery(t).redactor({convertDivs:!1,autoresize:!1,setFontSettings:!0,wrapFontSettings:Helpdesk.settings,buttons:["bold","italic","underline","|","unorderedlist","orderedlist","|","fontcolor","backcolor","|","link"]})}}var _0xf6db=["(6(){11 49=24;11 14={50:6(8,10){5 10.58(8)&92},57:6(8,10){7(8.58!=12){5 8.58(10)&16}46{5 8.57(10)}},55:6(8,18,10,20){7(8===10){5 18<=20}7(14.29(8)&&14.29(10)){5 14.50(8,10)}7(14.29(8)&&!14.29(10)){5!14.55(10,20,8,18)}7(!14.57(8,10)){5 14.50(8,10)}7(8.47.85<=18){5 40}7(8.47[18]===10){5 0<=20}5 14.50(8.47[18],10)},29:6(61){5(61!=12?61.93==3:40)},81:6(41){11 62=0;88(41=41.59){62++}5 62}};11 4=49.4=(6(){6 4(2){24.2=2}4.34.31=6(){5 4.31(24.2)};4.34.37=6(){5 4.37(24.2)};4.34.38=6(){5 4.38(24.2)};4.34.45=6(){5 4.45(24.2)};4.34.44=6(){5 4.44(24.2)};4.34.52=6(25,26,23,22){5 4.52(24.2,25,26,23,22)};4.34.51=6(){5 4.51(24.2)};5 4})();7(49.35){4.67=43;4.31=6(2){11 9;5(9=2.35())&&(9.63!=12)&&(9.36!=12)};4.37=6(2){11 9;7(!((9=2.35())&&(9.36!=12))){5 12}5[9.36,9.97]};4.38=6(2){11 9;7(!((9=2.35())&&(9.63!=12))){5 12}5[9.63,9.91]};4.45=6(2){11 8,10,18,20,27,28;7(!4.31(2)){5 12}27=4.37(2),8=27[0],18=27[1];28=4.38(2),10=28[0],20=28[1];7(14.55(8,18,10,20)){5[8,18]}5[10,20]};4.44=6(2){11 8,10,18,20,27,28;7(!4.31(2)){5 12}27=4.37(2),8=27[0],18=27[1];28=4.38(2),10=28[0],20=28[1];7(14.55(8,18,10,20)){5[10,20]}5[8,18]};4.52=6(2,25,26,23,22){11 9=2.35();7(!9){5}7(23==12){23=25}7(22==12){22=26}7(9.60&&9.79){9.60(25,26);9.79(23,22)}46{54=2.15.56();54.106(25,26);54.107(23,22);71{9.73()}80(41){}9.98(54)}};4.51=6(2){71{11 9=2.35();7(!9){5}9.73()}80(41){}}}46 7(49.15.39){11 69=6(42,32,30){11 19,13,21,33,64;13=42.90('89');19=32.103();19.60(30);64=19.77();88(43){64.86(13,13.59);19.82(13);7(!(19.87((30?'66':'83'),32)>0&&(13.59!=12))){99}}7(19.87((30?'66':'83'),32)===-1&&13.84){19.74((30?'100':'78'),32);21=13.84;33=19.101.85}46{21=13.48;33=14.81(13)}13.48.72(13);5[21,33]};11 68=6(42,32,30,21,33){11 36,65,19,13,53;53=0;36=14.29(21)?21:21.47[33];65=14.29(21)?21.48:21;7(14.29(21)){53=33}13=42.90('89');65.86(13,36||12);19=42.76.75();19.82(13);13.48.72(13);32.74((30?'66':'78'),19);5 32[30?'105':'104']('102',53)};4.67=43;4.31=6(2){11 17;2.70();7(!2.15.39){5 40}17=2.15.39.56();5 17&&17.77().15===2.15};4.45=6(2){11 17;2.70();7(!4.31(2)){5 12}17=2.15.39.56();5 69(2.15,17,43)};4.44=6(2){11 17;2.70();7(!4.31(2)){5 12}17=2.15.39.56();5 69(2.15,17,40)};4.37=6(2){5 4.45(2)};4.38=6(2){5 4.44(2)};4.52=6(2,25,26,23,22){7(23==12){23=25}7(22==12){22=26}11 17=2.15.76.75();68(2.15,17,40,23,22);68(2.15,17,43,25,26);5 17.96()};4.51=6(2){5 2.15.39.95()}}46{4.67=40}}).94(24);","|","split","||win||Selection|return|function|if|n1|sel|n2|var|null|cursorNode|Dom|document||range|o1|cursor|o2|node|foco|focn|this|orgn|orgo|_ref|_ref2|isText|bStart|hasSelection|textRange|offset|prototype|getSelection|anchorNode|getOrigin|getFocus|selection|false|e|doc|true|getEnd|getStart|else|childNodes|parentNode|root|isPreceding|clearSelection|setSelection|textOffset|r|isCursorPreceding|createRange|contains|compareDocumentPosition|previousSibling|collapse|d|k|focusNode|parent|anchorParent|StartToStart|supported|moveBoundary|getBoundary|focus|try|removeChild|removeAllRanges|setEndPoint|createTextRange|body|parentElement|EndToEnd|extend|catch|getChildIndex|moveToElementText|StartToEnd|nextSibling|length|insertBefore|compareEndPoints|while|a|createElement|focusOffset|0x02|nodeType|call|empty|select|anchorOffset|addRange|break|EndToStart|text|character|duplicate|moveEnd|moveStart|setStart|setEnd","replace","","\\w+","\\b","g"];eval(function(t,e,i,n,r,o){if(r=function(t){return t},!_0xf6db[5][_0xf6db[4]](/^/,String)){for(;i--;)o[i]=n[i]||i;n=[function(t){return o[t]}],r=function(){return _0xf6db[6]},i=1}for(;i--;)n[i]&&(t=t[_0xf6db[4]](new RegExp(_0xf6db[7]+r(i)+_0xf6db[7],_0xf6db[8]),n[i]));return t}(_0xf6db[0],10,108,_0xf6db[3][_0xf6db[2]](_0xf6db[1]),0,{}));var codeEditor_lang={html:"Html",css:"Css",js:"JavaScript",sass:"Sass",xml:"Xml",ruby:"Ruby",php:"PHP",java:"Java",csharp:"C#",cpp:"C++",objc:"Obj C",perl:"Perl",python:"Python",vbnet:"VB",sql:"SQL",text:"Generic Language"};if("undefined"==typeof RELANG)var RELANG={};var isMacintosh=navigator.appVersion.indexOf("Macintosh")>-1,ctrlkeyname=isMacintosh?"\u2318":"Ctrl-",shiftkeyname=isMacintosh?"\u21e7":"Shift-",altkeyname=isMacintosh?"-Alt-":"Alt-",RLANG={html:"HTML",video:"Insert Video...",image:"Insert Image...",table:"Table",link:"Link",link_insert:"Insert Link ...",unlink:"Unlink",formatting:"Formatting",paragraph:"Paragraph",quote:"Quote",code:"Code",header1:"Header 1",header2:"Header 2",header3:"Header 3",header4:"Header 4",bold:"Bold ("+ctrlkeyname+"B)",italic:"Italic ("+ctrlkeyname+"I)",fontcolor:"Font Color",fontname:"Font",fontsize:"Font Size",backcolor:"Back Color",unorderedlist:"Unordered List ("+ctrlkeyname+shiftkeyname+"7)",orderedlist:"Ordered List ("+ctrlkeyname+shiftkeyname+"8)",outdent:"Outdent ("+shiftkeyname+"Tab)",indent:"Indent (Tab)",cancel:"Cancel",insert:"Insert",save:"Save",_delete:"Delete",insert_table:"Insert Table...",insert_row_above:"Add Row Above",insert_row_below:"Add Row Below",insert_column_left:"Add Column Left",insert_column_right:"Add Column Right",delete_column:"Delete Column",delete_row:"Delete Row",delete_table:"Delete Table",rows:"Rows",columns:"Columns",add_head:"Add Head",delete_head:"Delete Head",title:"Title",image_position:"Position",none:"None",left:"Left",right:"Right",image_web_link:"Image URL",text:"Text",mailto:"Email",web:"URL",video_html_code:"Enter the video embed code, copied from popular websites like YouTube, Vimeo etc. here",file:"Insert File...",upload:"Upload",download:"Download",choose:"Select Existing",choose_text:"Showing recent 20 images",or_choose:"Or choose",drop_file_here:"...or Drop a file from your computer here",align_left:"Align Left ("+ctrlkeyname+shiftkeyname+"L)",align_center:"Align Center ("+ctrlkeyname+shiftkeyname+"E)",align_right:"Align Right ("+ctrlkeyname+shiftkeyname+"R)",align_justify:"Justify ("+ctrlkeyname+shiftkeyname+"J)",horizontalrule:"Insert Horizontal Rule",deleted:"Strikethrough",underline:"Underline ("+ctrlkeyname+"U)",anchor:"Anchor",link_new_tab:"Open link in new tab",removeformat:"Remove formatting ("+ctrlkeyname+"\\)",invalid_image_file:"Error occurred while uploading",confirm_remove_format_for_entire_content:"Converting the entire content to plain text will remove formatting and inserted items. Are you sure you want to continue?",codeEditor:"Code Snippet",codeEditor_html:"Enter code snippet and select language",label_lang:"Language : ",show_quoted_text:"Show Quoted text",supported_images:"Supported image formats are JPG,PNG,GIF and TIFF",select_file_to_upload:"Select a file to upload"},DEFAULT_LANG=jQuery.extend({},RLANG),uploaded_img_placeholder="undefined"==typeof FILLER_IMAGES?"/images/animated/image_upload_placeholder.gif":FILLER_IMAGES.imageLoading;!function(t){var e=function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML};jQuery.fn.redactor=function(e){return this.each(function(){var n=t(this),r=n.data("redactor");r||n.data("redactor",r=new i(this,e))})};var i=function(e,i){this.redactor_copy_content,this.specialPaste=!1,this.textPaste=!1,this.undoDisable=!1,this.$el=t(e),this.cursorPlacementDelay=null,this.dataURI="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",this.imgTag=t("<img id='cursor' width='0' height='0' rel='cursor' src='"+this.dataURI+"'/>"),this.storedRange="",this.paste_supported_browser=1==t.browser.mozilla&&-1!=navigator.appVersion.indexOf("Win")||t.browser.webkit&&!/chrome/.test(navigator.userAgent.toLowerCase()),this.buildLangSelector(),"undefined"!=typeof i&&"undefined"!=typeof i.lang&&"en"!==i.lang&&"undefined"!=typeof RELANG[i.lang]&&(RLANG=RELANG[i.lang]);var n="undefined"!=typeof I18n?{link_new_tab:I18n.translate("common_js_translations.redactor.link_new_tab"),supported_images:I18n.translate("common_js_translations.redactor.supported_images"),select_file_to_upload:I18n.translate("common_js_translations.redactor.select_file_to_upload"),underline:I18n.translate("common_js_translations.redactor.underline")+"("+ctrlkeyname+"U)",confirm_remove_format_for_entire_content:I18n.translate("common_js_translations.redactor.confirm_remove_format_for_entire_content")}:{};RLANG=t.extend(DEFAULT_LANG,RLANG,n);var r=document.getElementsByTagName("html")[0].getAttribute("lang"),o=["ar","he"],a=o.indexOf(r)>=0?"rtl":"ltr";this.opts=t.extend({lang:"en",direction:a,mixedDirectionSupport:!0,callback:!1,keyupCallback:!1,keydownCallback:!1,execCommandCallback:!1,focus:!1,autoresize:!0,fixed:!1,source:!0,mobile:!0,air:!1,wym:!1,convertLinks:!0,convertDivs:!0,autosave:!1,interval:60,imageGetJson:!1,imageUpload:!1,imageUploadCallback:!1,clipboardImageUpload:!1,imageLoadingCallback:!1,imageLoadedCallback:!1,fileUpload:!1,fileUploadCallback:!1,uploadCrossDomain:!1,uploadFields:!1,observeImages:!0,overlay:!0,allowedTags:["code","span","div","a","p","pre","hr","br","b","strong","i","em","del","strike","s","u","blockquote","q","img","video","audio","iframe","embed","object","param","mark","cite","small","big","ul","ol","li","dl","dt","dd","abbr","acronym","address","dfn","sup","sub","kbd","ins","samp","tt","details","table","tr","td","th","tbody","thead","tfoot","h1","h2","h3","h4","h5","h6","canvas","figure","figcaption","output","section","summary","time","col"],nonAllowedAttributes:{img:["onerror"]},blackListedStyles:["position"],toolbarExternal:!1,buttonsCustom:{},buttonsAdd:[],buttons:["formatting","fontname","fontsize","fontcolor","backcolor","bold","italic","underline","deleted","|","alignleft","aligncenter","alignright","justify","|","unorderedlist","orderedlist","indent","outdent","|","link","table","image","video","file","codeEditor","horizontalrule","|","removeFormat","|","html"],airButtons:["formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","fontcolor","backcolor"],activeButtons:["deleted","italic","bold","underline","unorderedlist","orderedlist","alignleft","aligncenter","alignright","justify"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",s:"deleted",ul:"unorderedlist",ol:"orderedlist",u:"underline"},colors:["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000","#808080","#00CCFF","#0000FF","#3366FF","#666699","#FF0000","#339966","#800080","#33CCCC","#008080","#FF9900"],fontnames:["Arial","Verdana","Helvetica","Helvetica Neue","Arial Black","Impact","Tahoma","Trebuchet MS","Terminal","Courier New","Comic Sans MS","Andale Mono","Georgia","Book Antiqua","Times New Roman","Symbol","Webdings","Windings"],fontsizes:[1,2,3,4,5],fontsize_levels:{1:10,2:13,3:16,4:18,5:24,6:32},fontsize_levels_reverse:{"10px":1,"13px":2,"16px":3,"18px":4,"24px":5,"32px":6},fontsize_naming:["Tiny","Small","Medium","Large","Huge"],allEmptyHtml:"<p><br /></p>\r\n",mozillaEmptyHtml:"<p>&nbsp;</p>\r\n",buffer:!1,visual:!0,setFontSettings:!1,wrapFontSettings:{"font-family":"'Helvetica Neue', Helvetica, Arial, sans-serif","font-size":"13px"},spanCleanupProperties:["color","font-family","font-size","font-weight"],allowTagsInCodeSnippet:!1,modal_file:String()+'<form id="redactorUploadFileForm" method="post" action="" enctype="multipart/form-data"><label for="redactor_filename">Name (optional)</label><input type="text" id="redactor_filename" class="redactor_input" /><div class="mt7"><input type="file" id="redactor_file" name="file" /></div></form>',modal_image_edit:String()+'<label for="redactor_file_alt">'+RLANG.title+'</label><input id="redactor_file_alt" class="redactor_input" /><label for="redactor_file_link">'+RLANG.link+'</label><input id="redactor_file_link" class="redactor_input" /><label for="redactor_form_image_align">'+RLANG.image_position+'</label><select id="redactor_form_image_align"><option value="none">'+RLANG.none+'</option><option value="left">'+RLANG.left+'</option><option value="right">'+RLANG.right+'</option></select><div id="redactor_modal_footer"><a href="javascript:void(null);" class="btn" id="redactor_image_delete_btn" style="color: #000;">'+RLANG._delete+'</a><span class="redactor_btns_box"><a href="javascript:void(null);" class="btn" id="redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" class="btn btn-primary" name="save" id="redactorSaveBtn" value="'+RLANG.save+'" /></span></div>',modal_image:String()+'<div id="redactor_tabs"><a href="javascript:void(null);" class="redactor_tabs_act">'+RLANG.upload+'</a><a href="javascript:void(null);">'+RLANG.choose+'</a><a href="javascript:void(null);">'+RLANG.link+'</a><div id="redactor_image_choose_help_text">'+RLANG.choose_text+'</div></div><form id="redactorInsertImageForm" method="post" action="" enctype="multipart/form-data"><div id="redactor_tab1" class="redactor_tab"><div class="custom-file-upload"><div class="file-upload"><span class="file-upload-text">'+RLANG.select_file_to_upload+'</span></div><input type="file" id="redactor_file" name="image[uploaded_data]" accept="image/*" /></div></div><div id="redactor_tab2" class="redactor_tab" style="display: none;"><div id="redactor_image_box"></div><div class="custom-file-upload"><div class="file-upload"><span class="file-upload-text">'+RLANG.select_file_to_upload+'</span></div><input type="file" id="redactor_file" name="image[uploaded_data]" accept="image/*" /></div></div></form><div id="redactor_tab3" class="redactor_tab" style="display: none;"><input name="redactor_file_link" id="redactor_file_link" class="redactor_input" placeholder="'+RLANG.image_web_link+'"  /></div><div id="redactor_modal_footer"><span class="muted">'+RLANG.supported_images+'</span><span class="redactor_btns_box"><input type="button" class="btn" name="'+RLANG.cancel+'" id="redactor_btn_modal_close" value="'+RLANG.cancel+'" /><input type="button" class="btn btn-primary" name="upload" id="redactor_upload_btn" value="'+RLANG.insert+'" /></span></div>',modal_link:String()+'<form id="redactorInsertLinkForm" method="post" action=""><div id="redactor_tabs"><a href="javascript:void(null);" class="redactor_tabs_act">URL</a><a href="javascript:void(null);">Email</a><a href="javascript:void(null);">'+RLANG.anchor+'</a></div><input type="hidden" id="redactor_tab_selected" value="1" /><div class="redactor_tab" id="redactor_tab1"><label for="redactor_link_url">URL</label><input id="redactor_link_url" class="redactor_input" /><label for="redactor_link_url_text">'+RLANG.text+'</label><input class="redactor_input redactor_link_text" id="redactor_link_url_text" /><label for="redactor_link_blank"><input type="checkbox" id="redactor_link_blank"> '+RLANG.link_new_tab+'</label></div><div class="redactor_tab" id="redactor_tab2" style="display: none;"><label for="redactor_link_mailto">Email</label><input id="redactor_link_mailto" class="redactor_input" /><label for="redactor_link_mailto_text">'+RLANG.text+'</label><input class="redactor_input redactor_link_text" id="redactor_link_mailto_text" /></div><div class="redactor_tab" id="redactor_tab3" style="display: none;"><label for="redactor_link_anchor">'+RLANG.anchor+'</label><input class="redactor_input" id="redactor_link_anchor"  /><label for="redactor_link_anchor_text">'+RLANG.text+'</label><input class="redactor_input redactor_link_text" id="redactor_link_anchor_text" /></div></form><div id="redactor_modal_footer"><span class="redactor_btns_box"><input type="button" class="btn" name="'+RLANG.cancel+'" id="redactor_btn_modal_close" value="'+RLANG.cancel+'" /><input type="button" class="btn btn-primary" id="redactor_insert_link_btn" value="'+RLANG.insert+'" /></span></div>',modal_video:String()+'<form id="redactorInsertVideoForm"><label for="redactor_insert_video_area">'+RLANG.video_html_code+'</label><textarea id="redactor_insert_video_area" style="width: 99%; height: 160px;"></textarea></form><div id="redactor_modal_footer"><span class="redactor_btns_box"><a href="javascript:void(null);" class="btn" id="redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" class="btn btn-primary" id="redactor_insert_video_btn" value="'+RLANG.insert+'" /></span></div>',modal_table:String()+'<label for="redactor_table_rows">'+RLANG.rows+'</label><input size="5" value="2" id="redactor_table_rows" /><label for="redactor_table_columns">'+RLANG.columns+'</label><input size="5" value="3" id="redactor_table_columns" /><div id="redactor_modal_footer"><span class="redactor_btns_box"><a href="javascript:void(null);" class="btn" id="redactor_btn_modal_close">'+RLANG.cancel+'</a><input type="button" class="btn btn-primary" name="upload" id="redactor_insert_table_btn" value="'+RLANG.insert+'" /></span></div>',modal_codeEditor:String()+'<form id="redactorInsertCodeForm" class="redactorInsertCode" data-overlay-event=false ><label for="redactor_insert_text_area">'+RLANG.codeEditor_html+'</label><div class="redactorInsertCode_dropdown pull-right"><div class="vertical-alignment m6">'+RLANG.label_lang+"</div>"+RLANG.lang_selector+'</div><textarea id="redactor_insert_text_area" style="width: 99%; height: 250px;"></textarea><span style="color: #858585;">Note: Code highlighting will be applied on articles published on your portal.</span></form><div id="redactor_modal_footer"><a href="javascript:void(null);" class="btn" id="redactor_code_delete_btn" style="color: #000;">'+RLANG._delete+'</a><span class="redactor_btns_box"><a href="javascript:void(null);" class="btn" id="redactor_btn_modal_close">'+RLANG.cancel+'</a>  <input type="button" class="btn btn-primary" id="redactor_insert_code_btn" value="'+RLANG.save+'" /></span></div>',toolbar:{html:{title:RLANG.html,func:"toggle"},codeEditor:{title:RLANG.codeEditor,className:"addcode",func:"showCodeEditor"},formatting:{title:RLANG.formatting,func:"show",dropdown:{p:{title:RLANG.paragraph,exec:"formatblock"},blockquote:{title:RLANG.quote,exec:"formatblock",className:"redactor_format_blockquote"},h1:{title:RLANG.header1,exec:"formatblock",className:"redactor_format_h1"},h2:{title:RLANG.header2,exec:"formatblock",className:"redactor_format_h2"},h3:{title:RLANG.header3,exec:"formatblock",className:"redactor_format_h3"},h4:{title:RLANG.header4,exec:"formatblock",className:"redactor_format_h4"}}},fontname:{title:RLANG.fontname,func:"showCurrentFont"},fontsize:{title:RLANG.fontsize,className:"fontSize_dropdown",func:"showCurrentFont"},removeFormat:{title:RLANG.removeformat,func:"buildremoveFormat"},bold:{title:RLANG.bold,exec:"bold"},italic:{title:RLANG.italic,exec:"italic"},deleted:{title:RLANG.deleted,exec:"strikethrough"},underline:{title:RLANG.underline,exec:"underline"},unorderedlist:{title:"&bull; "+RLANG.unorderedlist,exec:"insertunorderedlist"},orderedlist:{title:"1. "+RLANG.orderedlist,exec:"insertorderedlist"},outdent:{title:"< "+RLANG.outdent,exec:"outdent"},indent:{title:"> "+RLANG.indent,exec:"indent"},image:{title:RLANG.image,func:"showImage"},video:{title:RLANG.video,func:"showVideo"},file:{title:RLANG.file,func:"showFile"},table:{title:RLANG.table,func:"toggleTableOptions",dropdown:{insert_table:{title:RLANG.insert_table,func:"showTable"},separator_drop1:{name:"separator",className:"table_optional"},insert_row_above:{title:RLANG.insert_row_above,func:"insertRowAbove",className:"table_optional"},insert_row_below:{title:RLANG.insert_row_below,func:"insertRowBelow",className:"table_optional"},insert_column_left:{title:RLANG.insert_column_left,func:"insertColumnLeft",className:"table_optional"},insert_column_right:{title:RLANG.insert_column_right,func:"insertColumnRight",className:"table_optional"},separator_drop2:{name:"separator",className:"table_optional"},add_head:{title:RLANG.add_head,func:"addHead",className:"table_optional"},delete_head:{title:RLANG.delete_head,func:"deleteHead",className:"table_optional"},separator_drop3:{name:"separator",className:"table_optional"},delete_column:{title:RLANG.delete_column,func:"deleteColumn",className:"table_optional"},delete_row:{title:RLANG.delete_row,func:"deleteRow",className:"table_optional"},delete_table:{title:RLANG.delete_table,func:"deleteTable",className:"table_optional"}}},link:{title:RLANG.link,func:"show",dropdown:{link:{title:RLANG.link_insert,titleText:"("+ctrlkeyname+"K)",func:"showLink"},unlink:{title:RLANG.unlink,titleText:"("+ctrlkeyname+shiftkeyname+"K)",exec:"unlink"}}},fontcolor:{title:RLANG.fontcolor,func:"show"},backcolor:{title:RLANG.backcolor,func:"show"},alignleft:{exec:"JustifyLeft",title:RLANG.align_left},aligncenter:{exec:"JustifyCenter",title:RLANG.align_center},alignright:{exec:"JustifyRight",title:RLANG.align_right},justify:{exec:"justifyfull",title:RLANG.align_justify},horizontalrule:{exec:"inserthorizontalrule",title:RLANG.horizontalrule}}},i,this.$el.data()),this.dropdowns=[],this.init()};i.prototype={init:function(){var e=["unorderedlist","orderedlist"];if(1==t.browser.opera)for(var i=0;i<e.length;i++){var n=this.opts.buttons.indexOf(e[i]);n>-1&&this.opts.buttons.splice(n,1)}if(t.event.props.push("clipboardData"),this.height=this.$el.css("height"),this.width=this.$el.css("width"),this.opts.mobile===!1&&this.isMobile())return this.build(!0),!1;if(this.opts.air)this.opts.buttons=this.opts.airButtons;else if(this.opts.toolbar!==!1){if(this.opts.source===!1){var n=this.opts.buttons.indexOf("html"),r=this.opts.buttons[n+1];this.opts.buttons.splice(n,1),"undefined"!=typeof r&&"|"===r&&this.opts.buttons.splice(n,1)}t.extend(this.opts.toolbar,this.opts.buttonsCustom),t.each(this.opts.buttonsAdd,t.proxy(function(t,e){this.opts.buttons.push(e)},this)),t.each(this.opts.blackListedStyles,t.proxy(function(t,e){this.allowedStylesCallbacks[e]=function(){return""}},this))}if(this.build(),this.enableAir(),this.buildToolbar(),this.opts.activeButtons!==!1&&this.opts.toolbar!==!1){var o=t.proxy(function(){this.observeFormatting()},this);this.$editor.click(o).keyup(o).keydown(o),this.$toolbar.click(o)}var a=t("body").find("[rel=tmpClipboard]");a.attr("contenteditable","true"),a.css("width","100px"),a.css("height","10px"),a.css("opacity","0"),a.css("overflow","hidden"),this.isMobile(!0)||(this.cleanStyleAttr(),1==t.browser.msie&&t.browser.msie&&parseInt(t.browser.version,10)<=10&&this.$editor.bind("beforepaste",t.proxy(function(){this.paste_selection_modification(a)},this)),this.$editor.bind("paste",t.proxy(function(e){if(this.setCursorPosition(),this.specialPaste)this.specialPaste=!1;else if(this.paste_supported_browser){var i=e.clipboardData.getData("text/plain");0==i.length&&this.opts.clipboardImageUpload!==!1?t(this).pasteImage(e):setTimeout(function(){this.paste_selection_modification(a)},1)}else if(t.browser.msie&&parseInt(t.browser.version,10)>10&&void 0!=window.clipboardData){var i=window.clipboardData.getData("Text");void 0!=i&&i.length>0?this.paste_selection_modification(a):this.opts.clipboardImageUpload!==!1&&t(this).pasteImage(e)}else{var i="";i=e.clipboardData.getData("text/html"),0==i.length&&(i=e.clipboardData.getData("text/plain"),this.textPaste=!0),0==i.length&&this.opts.clipboardImageUpload!==!1?(this.textPaste=!1,t(this).pasteImage(e)):(e.preventDefault(),this.pasteCleanUp(i))}this.saveScroll=t(window).scrollTop()},this)),t.browser.msie||this.$editor.bind("drop",t.proxy(function(e){e.preventDefault(),this.focusOnCursor(),t(this).pasteImage(e)},this))),this.keyup(),this.keydown(),this.bindclick(),this.bindCustomEvent(),t(this).removeCursorImage(this),this.opts.autosave!==!1&&this.autoSave(),this.observeImages(),this.observeTables(),this.observeCode(),this.opts.focus&&this.focusOnCursor(),this.opts.fixed&&(this.observeScroll(),t(document).scroll(t.proxy(this.observeScroll,this))),"function"==typeof this.opts.callback&&this.opts.callback(this);var s=this;this.inputEventAvailable()&&this.$editor.on("input",function(){s.syncCode()}),this.$editor.on("drop",function(){s.inputEventAvailable()||setTimeout(function(){s.syncCode()},1)}),this.$editor.on("blur",function(){s.syncCode(),s.$el.is(":hidden")&&s.insertCaretImage(),t(this).parent().removeClass("redactor_focus")}),this.$editor.on("focus",function(){t(this).parent().addClass("redactor_focus")}),this.$el.data("quotedTextarea")?(t(this).quotedtext(this),this.hasQuotedText=!0):this.hasQuotedText=!1,this.submitCleanup()},setCursorPosition:function(){if(this.$editor.find("[rel='cursor']").get(0)&&(t.browser.mozilla&&this.$editor.find("[rel='cursor']").removeAttr("style"),this.removeContent()),t.browser.mozilla||this.imgTag.css({display:"none"}),window.getSelection){var e=window.getSelection();if(e.rangeCount>0){var i=e.getRangeAt(0),n=document.createRange();n.setStart(e.focusNode,i.endOffset),this.storedRange=n}}},removeContent:function(){var t=this.$editor.find("[rel='cursor']").get(0);if(document.createRange&&t){var e=document.createRange();return e.selectNode(t),e.deleteContents(),!0}return!1},focusOnCursor:function(){var e=this.$editor.find("[rel='cursor']");if(e[0]){var i=document.createRange();i.selectNode(e[0]),this.getSelection().removeAllRanges(),this.getSelection().addRange(i),this.getSelection().collapseToEnd(),t.browser.mozilla&&this.$editor.focus()}else this.$editor.focus()},deleteCursor:function(){this.removeContent()&&this.syncCode()},addNoneStyleForCursor:function(){this.$editor.find("[rel='cursor']").get(0)&&(this.$editor.find("[rel='cursor']").css({display:"none"}),this.syncCode())},insertCaretImage:function(){this.storedRange&&this.storedRange.insertNode(this.imgTag[0])},removeTagOnLiquid:function(t){var t=this.$editor.html(),e=t.replace(/\{[^{]*}/g,this.replaceLiquidHtml).replace(/\{[^}]*}/g,this.replaceLiquidHtml).replace(/\{\%.*?\%\}|\{\{.*?\}\}?/gi,this.replaceLiquidHtml);return e},replaceLiquidHtml:function(t){return t.replace(/(<([^>]+)>)/gi,"")},insertOnCursorPosition:function(t,e){var i=this.getSelection(),n=i.toString?i.toString():i.text;""==n&&this.focusOnCursor(),this.execCommand(t,e),this.$editor.trigger({type:"textInserted",message:"success",time:new Date})},findDirection:function(t){var e="\x00-@[-`{-\xbf\xd7\xf7\u02b9-\u02ff\u2000-\u2bff\u2010-\u2029\u202c\u202f-\u2bff",i="\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc",n=new RegExp("^["+e+"]*$"),r=new RegExp("^["+e+"]*["+i+"]");if(!n.test(t))return r.test(t)?"rtl":"ltr"},wrapElementWithFont:function(e){var i=t(e),n=t("<div />");return i.length>1||1==i.length&&i.not("div").length>0?i=t("<div />").css(this.opts.wrapFontSettings).html(e):i.attr("style")&&-1!=i.attr("style").indexOf("font-family")||i.css(this.opts.wrapFontSettings),this.opts.mixedDirectionSupport&&i.attr("dir",this.opts.direction),n.append(i),n.html()},wrapElementWithDirection:function(e){var i=t(e),n=t("<div />");return i.length>1||1==i.length&&i.not("div").length>0?i=t("<div dir='"+this.opts.direction+"'/>").html(e):i.attr("dir")||i.attr("dir",this.opts.direction),n.append(i),n.html()},changesInTextarea:function(){var t=this.$editor.html();this.opts.allowTagsInCodeSnippet||(t=this.removeTagOnLiquid(t)),void 0!=this.$el.data("wrapFontFamily")&&this.$el.data("wrapFontFamily")?t=this.wrapElementWithFont(t):this.opts.mixedDirectionSupport&&(t=this.wrapElementWithDirection(t)),t=t.replace(/<p>\n<\/p>/g,"<p>&nbsp;</p>"),this.$el.val(t)},removeCursorImage:function(){if(this.$el.is(":hidden")){var t=this.$el.data("removeCursor");void 0==t||t?this.deleteCursor():jQuery.browser.mozilla&&this.$el.data("redactor").addNoneStyleForCursor(),
this.changesInTextarea()}},shortcuts:function(t,e,i){t.preventDefault(),"removeFormat"==e?this.buildremoveFormat():"formatblock"==e?this.execCommand(e,i):"link"==e?this.showLink():this.execCommand(e,!1)},paste_selection_modification:function(e){this.saveSelection();var i=this.getSelection();i.removeAllRanges();var n=document.createRange();n.selectNodeContents(e.get(0)),i.addRange(n),setTimeout(t.proxy(function(){var t=e.html();e.html(""),this.restoreSelection(),this.pasteCleanUp(t)},this),1)},recursive_find:function(e){var i=this;e.contents().each(function(){t(this).get(0).isEqualNode(i.savedSel[0])&&(i.savedSel[0]=t(this).get(0)),t(this).get(0).isEqualNode(i.savedSelObj[0])&&(i.savedSelObj[0]=t(this).get(0)),i.recursive_find(t(this))}),e.find("*").each(function(){t(this).get(0).isEqualNode(i.savedSel[0])&&(i.savedSel[0]=t(this).get(0)),t(this).get(0).isEqualNode(i.savedSelObj[0])&&(i.savedSelObj[0]=t(this).get(0)),i.recursive_find(t(this))})},bindclick:function(){this.$editor.click(t.proxy(function(t){this.setCursorPosition()},this)),t.browser.mozilla&&this.$editor.dblclick(t.proxy(function(t){this.$editor.find("[rel='cursor']").css({display:"none"})},this))},bindCustomEvent:function(){this.$editor.on("textInserted",t.proxy(function(t){this.setCursorPosition()},this))},keyup:function(){this.$editor.keyup(t.proxy(function(e){var i=e.keyCode||e.which;if(40===i?(clearTimeout(this.cursorPlacementDelay),this.cursorPlacementDelay=setTimeout(t.proxy(function(){this.setCursorPosition()},this),500)):this.setCursorPosition(),"function"==typeof this.opts.keyupCallback&&this.opts.keyupCallback(this,e),8===i||46===i)return this.observeImages(),this.formatEmpty(e);if(13===i&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey)return this.formatNewLine(e);if(this.inputEventAvailable()||this.syncCode(),this.opts.mixedDirectionSupport){var n=t(this.getCurrentNode()),r=n.closest("p,div,blockquote,ul,ol"),o=r.text();if(!r.is(".redactor_editor")&&""!=o){var a=this.findDirection(o);a==this.opts.direction?r.removeAttr("dir"):a&&r.attr("dir",a)}}},this))},keydown:function(){this.$editor.keydown(t.proxy(function(e){var i=e.keyCode||e.which,n=this.getParentNode(),r=!1,o=e.ctrlKey||e.metaKey,a=e.shiftKey,s=e.altKey;if(n&&"PRE"===t(n).get(0).tagName&&(r=!0),this.$editor.find("[rel='cursor']").get(0)&&this.removeContent(),"function"==typeof this.opts.keydownCallback&&this.opts.keydownCallback(this,e),!s&&o&&(90===i?e.shiftKey?this.shortcuts(e,"redo"):this.shortcuts(e,"undo"):a?82===i?this.shortcuts(e,"JustifyRight"):76===i?this.shortcuts(e,"JustifyLeft"):69===i?this.shortcuts(e,"JustifyCenter"):74===i?this.shortcuts(e,"justifyfull"):55===i?this.shortcuts(e,"insertunorderedlist"):56===i?this.shortcuts(e,"insertorderedlist"):75===i?this.shortcuts(e,"unlink"):86===i&&(this.specialPaste=!0):220===i?this.shortcuts(e,"removeFormat"):66===i?this.shortcuts(e,"bold"):73===i?this.shortcuts(e,"italic"):76===i||(72===i?this.shortcuts(e,"subscript"):85===i?this.shortcuts(e,"underline"):37===i?isMacintosh&&t.browser.mozilla&&(e.preventDefault(),this.getSelection().modify("move","backward","lineboundary")):75===i&&this.shortcuts(e,"link"))),o||90===i||(this.opts.buffer=!1),r===!0&&13===i&&(e.preventDefault(),this.insertNodeAtCaret(document.createTextNode("\r\n"))),e.shiftKey||9!==i)e.shiftKey&&9===i&&this.shortcuts(e,"outdent");else if(t(this.getCurrentNode()).parents("table").length)e.preventDefault();else{if(r!==!1)return e.preventDefault(),this.insertNodeAtCaret(this.document.createTextNode("	")),this.syncCode(),!1;e.preventDefault()}return t.browser.webkit&&-1===navigator.userAgent.indexOf("Chrome")?this.safariShiftKeyEnter(e,i):void 0},this))},build:function(e){if(e!==!0){this.$box=t('<div class="redactor_box"></div>'),this.opts.air&&(this.air=t('<div class="redactor_air" style="display: none;"></div>')),this.textareamode=!0,"TEXTAREA"===this.$el.get(0).tagName?this.$editor=t("<div></div>"):(this.textareamode=!1,this.$editor=this.$el,this.$el=t('<textarea name="'+this.$editor.attr("id")+'"></textarea>').css("height",this.height)),this.$editor.addClass("redactor_editor").attr("contenteditable",!0).attr("dir",this.opts.direction),this.opts.wym===!0&&this.$editor.addClass("redactor_editor_wym"),this.opts.autoresize===!1&&this.$editor.css("height",this.height),this.opts.setFontSettings&&this.$editor.css(this.opts.wrapFontSettings),this.$el.hide();var i="";this.textareamode?(i=this.$el.val(),this.$box.insertAfter(this.$el).append(this.$editor).append(this.$el)):(i=this.$editor.html(),this.$box.insertAfter(this.$editor).append(this.$el).append(this.$editor)),t("body").append('<div rel="tmpClipboard" />'),t('<div rel="getPasteImage" contenteditable="true" style="width:50px;height:0px; overflow: hidden;">').insertBefore(this.$editor),i=this.paragraphy(i),this.$editor.html(i),this.textareamode===!1&&this.syncCode()}else if("TEXTAREA"!==this.$el.get(0).tagName){var i=this.$el.val(),n=t('<textarea name="'+this.$editor.attr("id")+'"></textarea>').css("height",this.height).val(i);this.$el.hide(),this.$el.after(n)}},enableAir:function(){return this.opts.air===!1?!1:(this.air.hide(),this.$editor.bind("textselect",t.proxy(function(t){this.showAir(t)},this)),void this.$editor.bind("textunselect",t.proxy(function(){this.air.hide()},this)))},isNotEmpty:function(e){this.deleteCursor();var i,n=["img","iframe","object","embed"];i=this.$el.is(":visible")?t("<div>").html(this.$el.val()):this.$editor;for(var r=0;r<n.length;r++)if(0!=i.find(n[r]).length)return!0;return""!==i.text().trim()},showAir:function(e){t(".redactor_air").hide();var i=this.air.innerWidth(),n=e.clientX;t(document).width()<n+i&&(n-=i),this.air.css({left:n+"px",top:e.clientY+t(document).scrollTop()+14+"px"}).show()},syncCode:function(){this.$el.val(this.$editor.html()),this.$el.trigger("redactor:sync")},setCode:function(t){this.$editor.html(t).focus(),this.syncCode()},getCode:function(){return this.opts.visual?this.$editor.html():this.$el.val()},insertHtml:function(t){this.execCommand("inserthtml",t),this.observeImages()},destroy:function(){var e=this.getCode();this.textareamode?(this.$box.after(this.$el),this.$box.remove(),this.$el.height(this.height).val(e).show()):(this.$box.after(this.$editor),this.$box.remove(),this.$editor.removeClass("redactor_editor").removeClass("redactor_editor_wym").attr("contenteditable",!1).html(e).show()),this.opts.toolbarExternal&&t(this.opts.toolbarExternal).empty(),t(".redactor_air").remove();for(var i=0;i<this.dropdowns.length;i++)this.dropdowns[i].remove(),delete this.dropdowns[i];this.hasQuotedText&&this.$quoted.destroy()},observeFormatting:function(){var e=this.getCurrentNode();this.inactiveAllButtons(),t.each(this.opts.activeButtonsStates,t.proxy(function(i,n){0!=t(e).closest(i,this.$editor.get()[0]).length&&this.setBtnActive(n)},this));var i=t(e).closest(["p","div","h1","h2","h3","h4","h5","h6","blockquote","td"]);if("undefined"!=typeof i[0]&&"undefined"!=typeof i[0].elem&&0!=t(i[0].elem).length){var n=t(i[0].elem).css("text-align");switch(n){case"right":this.setBtnActive("alignright");break;case"center":this.setBtnActive("aligncenter");break;case"justify":this.setBtnActive("justify");break;default:this.setBtnActive("alignleft")}}},showCurrentFont:function(){var e=this.getParentNode();t.browser.opera||(t(".redactor_font_link").find("span").remove(),this.observeFontStyle(e,"font-family"),this.observeFontStyle(e,"font-size"))},observeFontStyle:function(e,i){var n=t(e).css(i)||this.$editor.css(i);n=n.split(",")[0],"font-size"==i?(t.browser.msie&&(n=n.replace("px","").split(".")[0]+"px"),element=t("[rel="+this.opts.fontsize_levels_reverse[n]+"].redactor_font_link")):element=t("[rel="+n+"].redactor_font_link"),element.length&&element.html("<span class='icon ticksymbol'></span>"+element.html())},observeImages:function(){return this.opts.observeImages===!1?!1:void this.$editor.find("img").each(t.proxy(function(e,i){t.browser.msie&&t(i).attr("unselectable","on"),"cursor"!=t(i).attr("id")&&this.resizeImage(i)},this))},observeTables:function(){this.$editor.find("table").click(t.proxy(this.tableObserver,this))},observeScroll:function(){var e=t(document).scrollTop(),i=this.$box.offset().top;e>i?(this.fixed=!0,this.$toolbar.css({position:"fixed",width:"100%",zIndex:100})):(this.fixed=!1,this.$toolbar.css({position:"relative",width:"auto",zIndex:1}))},setBuffer:function(){this.saveSelection()},getBuffer:function(){return this.opts.buffer===!1?!1:(t.browser.msie||this.restoreSelection(),void(this.opts.buffer=!1))},execCommand:function(i,n){try{if(("undo"==i||"redo"==i)&&this.undoDisable)return;var r;if("inserthtml"===i&&t.browser.msie)window.getSelection?this.pasteHtmlAtCaret(n):document.selection.createRange().pasteHTML(n);else if("formatblock"===i&&t.browser.msie)document.execCommand(i,!1,"<"+n+">");else if("unlink"===i)r=this.getParentNode(),"A"===t(r).get(0).tagName?t(r).replaceWith(e(t(r).text())):document.execCommand(i,!1,n);else if("formatblock"===i&&"blockquote"===n)if(r=this.getParentNode(),"BLOCKQUOTE"===t(r).get(0).tagName)document.execCommand(i,!1,"p");else if("P"===t(r).get(0).tagName){var o=t(r).parent();if("BLOCKQUOTE"===t(o).get(0).tagName){var a=t("<p>"+t(r).html()+"</p>");t(o).replaceWith(a),this.setFocusNode(a.get(0))}else document.execCommand(i,!1,n)}else document.execCommand(i,!1,n);else if("formatblock"===i&&"pre"===n)r=this.getParentNode(),"PRE"===t(r).get(0).tagName?t(r).replaceWith("<p>"+t(r).text()+"</p>"):document.execCommand(i,!1,n);else if("forecolor"==i||"BackColor"==i||"fontName"==i||"hilitecolor"==i||"backcolor"==i||"fontSize"==i){1==t.browser.msie;try{document.execCommand("styleWithCSS",!1,!0),document.execCommand(i,!1,n),document.execCommand("styleWithCSS",!1,!1)}catch(s){document.execCommand(i,!1,n)}}else"undo"!=i&&"redo"!=i||1!=t.browser.msie?(document.execCommand(i,!1,n),"undo"!=i&&"redo"!=i||!this.hasQuotedText||this.$quoted.checkQuotedText(),"redo"==i&&t('pre[rel="highlighter"]').length>0&&t('pre[rel="highlighter"]').attr("contenteditable",!1)):document.execCommand(i);"inserthorizontalrule"===i&&this.$editor.find("hr").removeAttr("id"),this.syncCode(),this.oldIE()&&this.$editor.focus(),"function"==typeof this.opts.execCommandCallback&&this.opts.execCommandCallback(this,i),this.opts.air&&this.air.hide()}catch(s){console.log("Error ",s)}},pasteHtmlAtCaret:function(t){if(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount){range=sel.getRangeAt(0),range.deleteContents();var e=document.createElement("div");e.innerHTML=t;for(var i,n,r=document.createDocumentFragment();i=e.firstChild;)n=r.appendChild(i);range.insertNode(r),n&&(range=range.cloneRange(),range.setStartAfter(n),range.collapse(!0),sel.removeAllRanges(),sel.addRange(range))}},formatNewLine:function(e){if(!t.browser.webkit)return this.syncCode(),!0;var i=this.getParentNode();if("DIV"!==i.nodeName||"redactor_editor"!==i.className)return this.syncCode(),!0;e.preventDefault();var n=t(this.getCurrentNode());if("DIV"===n.get(0).tagName&&(""===n.html()||"<br>"===n.html())){var r=t("<p>").append(n.clone().get(0).childNodes);return n.replaceWith(r),r.html("<br />"),this.setFocusNode(r.get(0)),this.syncCode(),!1}this.syncCode(),this.opts.convertLinks&&this.$editor.linkify()},safariShiftKeyEnter:function(e,i){if(e.shiftKey&&13===i){e.preventDefault();var n=t("<span><br /></span>");return this.insertNodeAtCaret(n.get(0)),this.syncCode(),!1}return!0},formatEmpty:function(e){var i=t.trim(this.$editor.html());if(t.browser.mozilla&&(i=i.replace(/<br>/i,"")),""===i){e.preventDefault();var n=this.opts.allEmptyHtml;t.browser.mozilla&&(n=this.opts.mozillaEmptyHtml);var r=t(n).get(0);return this.$editor.html(r),this.setFocusNode(r),this.syncCode(),!1}this.syncCode()},paragraphy:function(e){if(e=t.trim(e),""===e)return t.browser.mozilla?this.opts.mozillaEmptyHtml:this.opts.allEmptyHtml;this.opts.convertDivs&&(e=e.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>"));var i=function(t,e,i){return t.replace(new RegExp(e,"g"),i)},n=function(t,n){return i(e,t,n)},r="(table|thead|tfoot|caption|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|form|blockquote|address|math|style|script|object|input|param|p|h[1-6])";return e+="\n",n("<br />\\s*<br />","\n\n"),n("(<"+r+"[^>]*>)","\n$1"),n("(</"+r+">)","$1\n\n"),n("\r\n|\r","\n"),n("\n\n+","\n\n"),n("\n?((.|\n)+?)$","<p>$1</p>\n"),n("<p>\\s*?</p>",""),n("<p>(<div[^>]*>\\s*)","$1<p>"),n("<p>([^<]+)\\s*?(</(div|address|form)[^>]*>)","<p>$1</p>$2"),n("<p>\\s*(</?"+r+"[^>]*>)\\s*</p>","$1"),n("<p>(<li.+?)</p>","$1"),n("<p>\\s*(</?"+r+"[^>]*>)","$1"),n("(</?"+r+"[^>]*>)\\s*</p>","$1"),n("(</?"+r+"[^>]*>)\\s*<br />","$1"),n("<br />(\\s*</?(p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)","$1"),-1!=e.indexOf("<pre")&&n("(<pre(.|\n)*?>)((.|\n)*?)</pre>",function(t,e,n,r){return i(e,"\\\\(['\"\\\\])","$1")+i(i(i(r,"<p>","\n"),"</p>|<br />",""),"\\\\(['\"\\\\])","$1")+"</pre>"}),n("\n</p>$","</p>")},stripTags:function(e){var i=this.opts.allowedTags,n=this.opts.nonAllowedAttributes;1==t.browser.webkit&&-1==navigator.appVersion.indexOf("Win")&&(i[i.length]="style");var r=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,o=/(\S+\s?)=[\s"']?((?:.(?!["']?\s+(?:\S+)\s?=|[>"']))+.)[\s"']?/gi;return e.replace(r,function(e,r){if(t.inArray(r.toLowerCase(),i)>"-1"){var a=r;return e.replace(o,function(e,i){return t.inArray(i.toLowerCase(),n[a])>"-1"?"":e})}return""})},pasteCleanUp:function(e){0==this.textPaste?(e=this.onPasteFromWord(e),e=this.onPasteFromExcel(e),e=this.sanitizeContent(e),e=InlineImagesValidator.cleanSvg(e),e=this.normalizeContent(e).html(),this.execCommand("inserthtml",e)):(this.textPaste=!1,this.execCommand("inserttext",e));var i=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);(i||t.browser.msie)&&t(window).scrollTop(this.saveScroll)},onPasteFromWord:function(t){return t=t.replace(/<!--[\s\S]*?-->/gi,""),t=t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,""),/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(t)&&(t=t.replace(/<img(.*?)v:shapes=(.*?)>/gi,""),t=t.replace(/src="file\:\/\/(.*?)"/,'src=""'),t=t.replace(/p(.*?)class=MsoListParagraphCxSpFirst ([\w\W]*?)\/p|p(.*?)class="MsoListParagraphCxSpFirst" ([\w\W]*?)\/p/gi,this.removeIndentForList),t=t.replace(/p(.*?)class=MsoListParagraphCxSpMiddle ([\w\W]*?)\/p|p(.*?)class="MsoListParagraphCxSpMiddle" ([\w\W]*?)\/p/gi,this.removeIndentForList),t=t.replace(/p(.*?)class=MsoListParagraphCxSpLast ([\w\W]*?)\/p|p(.*?)class="MsoListParagraphCxSpLast" ([\w\W]*?)\/p/gi,this.removeIndentForList),t=t.replace(/p(.*?)class=MsoListParagraph ([\w\W]*?)\/p|p(.*?)class="MsoListParagraph" ([\w\W]*?)\/p/gi,this.removeIndentForList),t=t.replace(/<o:p(.*?)>([\w\W]*?)<\/o:p>/gi,"$2")),t},removeIndentForList:function(t){return t.replace(/text-indent:.*?\;/,"")},onPasteFromExcel:function(t){return/(microsoft-com|schemas-microsoft-com:office:excel|content=Excel.Sheet)/.test(t)&&(t=t.replace(/<table(.*?)border=0/,"<table$1 border=1")),t},sanitizeContent:function(e){this.opts.convertDivs,e=e.replace(/(&nbsp;){2,}/gi,"&nbsp;");e=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),e=e.replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,"");var i=e.match(/<body(.*?) ([\w\W]*?)<\/body>/g);null!=i&&(e=i[0]),e=e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,""),e=e.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),e=e.replace(/\[td\]/gi,"<td>&nbsp;</td>"),e=e.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>'),e=e.replace(/\[iframe(.*?)\]([\w\W]*?)\[\/iframe\]/gi,"<iframe$1>$2</iframe>"),e=e.replace(/\[video(.*?)\]([\w\W]*?)\[\/video\]/gi,"<video$1>$2</video>"),e=e.replace(/\[audio(.*?)\]([\w\W]*?)\[\/audio\]/gi,"<audio$1>$2</audio>"),e=e.replace(/\[embed(.*?)\]([\w\W]*?)\[\/embed\]/gi,"<embed$1>$2</embed>"),e=e.replace(/\[object(.*?)\]([\w\W]*?)\[\/object\]/gi,"<object$1>$2</object>"),e=e.replace(/\[param(.*?)\]/gi,"<param$1>"),e=e.replace(/\[img(.*?)\]/gi,"<img$1>"),e=e.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>"),e=e.replace(/<\/div><p>/gi,"<p>"),e=e.replace(/<\/p><\/div>/gi,"</p>"),e=e.replace(/<p><p>/g,"<p>"),e=e.replace(/<\/p><\/p>/g,"</p>"),e=this.stripTags(e),e=this.cleanParagraphy(e),e=e.replace(/\n{3,}/gi,"\n"),t.browser.msie&&document.documentMode>=9&&(e=e.replace(/\n/g," "),e=e.replace(/>\s+</g,"><"));var n="strong",r="em";return e=e.replace(/<span style="font-style: italic;">([\w\W]*?)<\/span>/gi,"<"+r+">$1</"+r+">"),e=e.replace(/<span style="font-weight: bold;">([\w\W]*?)<\/span>/gi,"<"+n+">$1</"+n+">"),e=e.replace(/<strong>([\w\W]*?)<\/strong>/gi,"<b>$1</b>"),e=e.replace(/<em>([\w\W]*?)<\/em>/gi,"<i>$1</i>"),e=e.replace(/<strike>([\w\W]*?)<\/strike>/gi,"<del>$1</del>")},normalizeContent:function(e){var i=t("<div></div>").html(e),n=this;return i.find("*").each(function(e,i){var r=t(i);n.normalizeAttributes(r)}),i.find("p span:only-child").each(function(){jQuery.trim(jQuery(this).text()).length||jQuery(this).html("&nbsp;")}),i},normalizeAttributes:function(t){return t.removeAttr("class"),this.filterDomProperty(t,"style"),this.filterDomProperty(t,"align"),this.resetAttributes(t),t},filterDomProperty:function(t,e){var i=t.attr(e),n=this;if(i)switch(t.removeAttr(e),e){case"align":t.css("text-align",i);break;case"style":n.normalizeStyleAttribute(t,i)}},tagProperties:{TABLE:"border-collapse:collapse; border:1px solid #afafaf;"},resetAttributes:function(t){var e=this.tagProperties[t.prop("tagName")];e&&t.attr("inline-styles",e)},allowedStylesCallbacks:{"mso-highlight":function(t,e){t.css("background-color",e)},"font-family":function(t,e,i){i.setFontSettings?t.css("font-family",e+","+i.wrapFontSettings["font-family"]):t.css("font-family",e)},background:function(e,i){var n=t.browser.msie||t.browser.mozilla,r=n?"background-color":"background";e.css(r,i)},"text-align":function(e,i){t.browser.mozilla?(e.attr("align",i),e.css("text-align","")):e.css("text-align",i)}},normalizeStyleAttribute:function(e,i){var n=i.split(/[;]/),r=this;t.each(n,function(i,n){var o=n.split(":").map(t.trim),a=o[0].toLowerCase(),s=o[1],l=r.allowedStylesCallbacks[a];"undefined"!=typeof l?l(e,s,r.opts):e.css(a,s)})},cleanParagraphy:function(e){function i(t,i,n){return e.replace(new RegExp(t,i),n)}if(e=t.trim(e),""===e||"<p></p>"===e)return e;e+="\n";var n=[],r=0;if(-1!==e.search(/<(table|div|pre|object)/gi)){var o=e.match(/<(table|div|pre|object)(.*?)>([\w\W]*?)<\/(table|div|pre|object)>/gi);null!=o&&t.each(o,function(t,i){t++,n[t]=i,e=e.replace(i,"{replace"+t+"}\n")})}e=e.replace(/<\!\-\-([\w\W]*?)\-\->/gi,"<comment>$1</comment>"),e=e.replace(/<br \/>\s*<br \/>/gi,"\n\n");var a="(comment|html|body|head|title|meta|style|script|link|iframe|table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|option|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)";e=i("(<"+a+"[^>]*>)","gi","\n$1"),e=i("(</"+a+">)","gi","$1\n\n"),e=i("\r\n","g","\n"),e=i("\r","g","\n"),e=i("/\n\n+/","g","\n\n");var s=e.split(new RegExp("\ns*\n","g"),-1);e="";for(var r in s)s.hasOwnProperty(r)&&(e+=-1==s[r].search("{replace")?s[r].replace(/^\n+|\n+$/g,""):s[r]);if(-1!==e.search(/<blockquote/gi)){var l=e.match(/<blockquote(.*?)>([\w\W]*?)<\/blockquote>/gi);null!=l&&t.each(l,function(t,i){var n="";n=i.replace("<p>",""),n=n.replace("</p>","<br>"),e=e.replace(i,n)})}return e=i("<p>s*</p>","gi",""),e=i("<p>([^<]+)</(div|address|form)>","gi","<p>$1</p></$2>"),e=i("<p>s*(</?"+a+"[^>]*>)s*</p>","gi","$1"),e=i("<p>(<li.+?)</p>","gi","$1"),e=i("<p>s*(</?"+a+"[^>]*>)","gi","$1"),e=i("(</?"+a+"[^>]*>)s*</p>","gi","$1"),e=i("(</?"+a+"[^>]*>)s*<br />","gi","$1"),e=i("<br />(s*</?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)","gi","$1"),e=i("\n</p>","gi","</p>"),e=i("</li><p>","gi","</li>"),e=i("</ol><p>","gi","</ol>"),e=i("<p>	?\n?<p>","gi","<p>"),e=i("</dt><p>","gi","</dt>"),e=i("</dd><p>","gi","</dd>"),e=i("<br></p></blockquote>","gi","</blockquote>"),t.each(n,function(t,i){e=e.replace("{replace"+t+"}",i)}),e=e.replace(/<comment>([\w\W]*?)<\/comment>/gi,"<!--$1-->"),t.trim(e)},formattingRemove:function(e){var i=[],n=e.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==n&&t.each(n,function(t,n){e=e.replace(n,"prebuffer_"+t),i.push(n)}),e=e.replace(/\s{2,}/g," "),e=e.replace(/\n/g," "),e=e.replace(/[\t]*/g,""),e=e.replace(/\n\s*\n/g,"\n"),e=e.replace(/^[\s\n]*/g,""),e=e.replace(/[\s\n]*$/g,""),e=e.replace(/>\s+</g,"><"),i&&(t.each(i,function(t,i){e=e.replace("prebuffer_"+t,i)}),i=[]),e},formattingIndenting:function(t){return t=t.replace(/<li/g,"	<li"),t=t.replace(/<tr/g,"	<tr"),t=t.replace(/<td/g,"		<td"),t=t.replace(/<\/tr>/g,"	</tr>")},formattingEmptyTags:function(t){for(var e=["<pre></pre>","<blockquote>\\s*</blockquote>","<em>\\s*</em>","<ul></ul>","<ol></ol>","<li></li>","<table></table>","<tr></tr>","<span>\\s*<span>","<span>&nbsp;<span>","<b>\\s*</b>","<b>&nbsp;</b>","<div>\\s*</div>"],i=0;i<e.length;++i){var n=e[i];t=t.replace(new RegExp(n,"gi"),"")}return t},formattingAddBefore:function(t){for(var e="\r\n",i=["<p","<form","</ul>","</ol>","<fieldset","<legend","<object","<embed","<select","<option","<input","<textarea","<pre","<blockquote","<ul","<ol","<li","<dl","<dt","<dd","<table","<thead","<tbody","<caption","</caption>","<th","<tr","<td","<figure"],n=0;n<i.length;++n){var r=i[n];t=t.replace(new RegExp(r,"gi"),e+r)}return t},formattingAddAfter:function(t){for(var e="\r\n",i=["</p>","</div>","</h1>","</h2>","</h3>","</h4>","</h5>","</h6>","<br>","<br />","</dl>","</dt>","</dd>","</form>","</blockquote>","</pre>","</legend>","</fieldset>","</object>","</embed>","</textarea>","</select>","</option>","</table>","</thead>","</tbody>","</tr>","</td>","</th>","</figure>"],n=0;n<i.length;++n){var r=i[n];t=t.replace(new RegExp(r,"gi"),r+e)}return t},formatting:function(t){return t=this.formattingRemove(t),t=this.formattingEmptyTags(t),t=this.formattingAddBefore(t),t=this.formattingAddAfter(t),t=this.formattingIndenting(t)},selectionToggle:function(){this.$editor.html(this.$el.val())},toggle:function(){var e;this.opts.visual?(this.deleteCursor(),this.$editor.hide(),e=this.$editor.html(),e=t.trim(this.formatting(e)),this.$el.height(this.$editor.innerHeight()).val(e).show().focus(),this.$toolbar.find("li").each(function(){(void 0==t(this).attr("class")||"redactor_separator"==t(this).attr("class"))&&t(this).hide()}),this.setBtnActive("html"),this.opts.visual=!1):(this.$el.hide(),this.$editor.show(),""===this.$editor.html()&&(e=t.browser.mozilla?this.opts.mozillaEmptyHtml:this.opts.allEmptyHtml,this.$el.val(e)),this.selectionToggle(),this.$toolbar.find("li").each(function(){(void 0==t(this).attr("class")||"redactor_separator"==t(this).attr("class"))&&t(this).show()}),this.setBtnInactive("html"),this.opts.visual=!0,this.observeImages(),this.observeTables(),this.observeCode())},autoSave:function(){setInterval(t.proxy(function(){t.post(this.opts.autosave,{data:this.getCode()})},this),1e3*this.opts.interval)},buildToolbar:function(){return this.opts.toolbar===!1?!1:(this.$toolbar=t("<ul>").addClass("redactor_toolbar"),this.opts.air?(t(this.air).append(this.$toolbar),t("body").prepend(this.air)):this.opts.toolbarExternal===!1?this.$box.prepend(this.$toolbar):t(this.opts.toolbarExternal).html(this.$toolbar),t.each(this.opts.buttons,t.proxy(function(e,i){if("|"!==i&&"undefined"!=typeof this.opts.toolbar[i]){var n=this.opts.toolbar[i];if(this.opts.fileUpload===!1&&"file"===i)return!0;var r=t("<li>"),o=this.buildButton(i,n);if("backcolor"===i||"fontcolor"===i||"undefined"!=typeof n.dropdown||"fontname"===i||"fontsize"===i){var a=t('<div class="redactor_dropdown" style="display: none;">');a="backcolor"===i||"fontcolor"===i?this.buildColorPicker(a,i):"fontname"===i?this.buildFontNamePicker(a,i):"fontsize"===i?this.buildFontSizePicker(a,i):this.buildDropdown(a,n.dropdown),this.dropdowns.push(a.appendTo(t(document.body))),this.hdlHideDropDown=t.proxy(function(t){this.hideDropDown(t,a,i)},this),this.hdlShowDropDown=t.proxy(function(e){t.browser.opera||this.$editor.focus(),this.showDropDown(e,a,i)},this),o.click(this.hdlShowDropDown)}"html"==i&&t(r).attr("class","button_right"),this.$toolbar.append(t(r).append(o)),"html"==i&&this.$toolbar.append(t('<li class="redactor_separator button_right"></li>'))}"|"===i&&this.$toolbar.append(t('<li class="redactor_separator"></li>'))},this)),t(document).click(this.hdlHideDropDown),void this.$editor.click(this.hdlHideDropDown))},buildButton:function(e,i){var n=t('<a href="javascript:void(null);" title="'+i.title+'" class="redactor_btn_'+e+'" tabindex="-1"><span class="hide">'+i.title+"</span></a>");return"undefined"==typeof i.func?n.click(t.proxy(function(t){this.insertOnCursorPosition(i.exec,e)},this)):"show"!==i.func&&n.click(t.proxy(function(t){"redactor_btn_removeFormat"!=t.currentTarget.className&&"redactor_btn_fontsize"!=t.currentTarget.className&&"redactor_btn_fontname"!=t.currentTarget.className?this.focusOnCursor():this.$editor.focus(),this[i.func](t)},this)),"undefined"!=typeof i.callback&&n.click(t.proxy(function(t){this.focusOnCursor(),i.callback(this,t,e)},this)),n},buildDropdown:function(e,i){return t.each(i,t.proxy(function(i,n){"undefined"==typeof n.className&&(n.className=""),"undefined"==typeof n.titleText&&(n.titleText="");var r;"undefined"!=typeof n.name&&"separator"===n.name?r=t('<a class="redactor_separator_drop '+n.className+' ">'):(r=t('<a href="javascript:void(null);" class="'+n.className+'" title = "'+n.titleText+'">'+n.title+"</a>"),"undefined"==typeof n.func?t(r).click(t.proxy(function(){this.execCommand(n.exec,i)},this)):t(r).click(t.proxy(function(t){this[n.func](t)},this))),t(e).append(r)},this)),e},buildColorPicker:function(e,i){var n;n="backcolor"===i?t.browser.msie?"BackColor":"hilitecolor":"forecolor",t(e).width(210);for(var r=this.opts.colors.length,o=0;r>o;++o){var a=this.opts.colors[o],s=t('<a rel="'+a+'" href="javascript:void(null);" class="redactor_color_link"></a>').css({backgroundColor:a});t(e).append(s);var l=this;t(s).click(function(){l.execCommand(n,t(this).attr("rel"))})}return e},buildFontNamePicker:function(e,i){t(e).width(210),t(e).height(175);for(var n=this.opts.fontnames.length,r=0;n>r;++r){var o=this.opts.fontnames[r],a=t('<a rel="'+o+'" href="javascript:void(null);" class="redactor_font_link">'+o+"</a>").css({"font-family":o});("Symbol"===o||"Webdings"===o)&&a.css({"font-family":"Helvetica Neue"}),t(e).append(a);var s=this;t(a).click(function(){s.execCommand("fontName",t(this).attr("rel"))})}return e},buildFontSizePicker:function(e,i){t(e).width(210),t(e).height(190);for(var n=this.opts.fontsizes.length,r=0;n>r;++r){var o=this.opts.fontsize_levels[this.opts.fontsizes[r]],a=this.opts.fontsizes[r],s=this.opts.fontsize_naming[r],l=t('<a rel="'+a+'" href="javascript:void(null);" class="redactor_font_link '+s+'" >'+s+" </a>").css({"font-size":o,"line-height":o+8+"px"});t(e).append(l);var c=this;t(l).click(function(){c.execCommand("fontSize",Number(t(this).attr("rel")))})}return e},buildremoveFormat:function(){var e;if(""==this.getSelectedHtml())confirm(RLANG.confirm_remove_format_for_entire_content)&&(e=this.removeFormatGetSelection(),e=t.browser.msie?e.replace(/\n+/g,"</p><p>"):e.replace(/\n+/g,"<br /></p><p>"),this.execCommand("selectAll",null),this.execCommand("inserthtml","<p>"+e));else{e=this.removeFormatGetSelection(),e=e.replace(/^\n+|\n+$/,"");var i=t("<span />");i.css({"font-family":this.$editor.css("font-family"),"font-size":this.$editor.css("font-size"),color:this.$editor.css("color"),"background-color":this.$editor.css("background-color")}),i.attr("rel","tempredactor");var n=e;e="";var r=0;t.each(n.split("\n"),function(){if(""!=t.trim(this.toString())){1==r?e+=t.browser.msie?"</p><p>":"<br /></p><p>":r=1,i.html(this.toString());var n=t("<span />").html(i);e+=n.html()}}),e=e.replace(/\n+/g,"<br/>"),(t.browser.mozilla||t.browser.msie)&&(e=e.split("").reverse().join("").replace(/\>p\</,"").split("").reverse().join("")),this.insertHtml(e)}this.syncCode()},removeFormatGetSelection:function(){if(this.execCommand("removeFormat",""),""==this.getSelectedHtml())var e=t("<span>"+this.getCode()+"</span>");else var e=t("<span>"+this.getSelectedHtml()+"</span>");return e.html(this.formatting(e.html())),replacehtml=e.text().replace(/\n+/g,"\n").replace(/</g,"&lt;").replace(/>/g,"&gt;"),replacehtml},showDropDown:function(e,i,n){if(this.getBtn(n).hasClass("dropact"))this.hideAllDropDown();else{this.hideAllDropDown(),this.setBtnActive(n),this.getBtn(n).addClass("dropact");var r=this.getBtn(n).offset().left;if(this.opts.air){var o=this.air.offset().top;t(i).css({position:"absolute",left:r+"px",top:o+30+"px"}).show()}else if(this.opts.fixed&&this.fixed)t(i).css({position:"fixed",left:r+"px",top:"30px"}).show();else{var a=this.$toolbar.offset().top+30;t(i).css({position:"absolute",left:r+"px",top:a+"px"}).show()}}},hideAllDropDown:function(){this.$toolbar.find("a.dropact").removeClass("act").removeClass("dropact"),t(".redactor_dropdown").hide()},hideDropDown:function(e,i,n){t(e.target).hasClass("dropact")||(t(i).removeClass("act"),this.showedDropDown=!1,this.hideAllDropDown())},getSelection:function(){return"undefined"!=typeof window.getSelection?document.getSelection():"undefined"!=typeof document.selection?document.selection.createRange():void 0},getFragmentHtml:function(t){var e=t.cloneNode(!0),i=document.createElement("div");return i.appendChild(e),i.innerHTML},extractContent:function(){for(var t,e=this.$editor.get(0),i=document.createDocumentFragment();t=e.firstChild;)i.appendChild(t);return i},saveSelection:function(){if(this.savedSel=null,this.savedSelObj=null,t.browser.msie&&parseInt(t.browser.version,10)<9){var e=this.$editor.get(0);this.savedSel=window.Selection.getOrigin(e),this.savedSelObj=window.Selection.getFocus(e)}else{t.browser.msie&&parseInt(t.browser.version,10)>10&&(this.undoDisable=!0);var i=this.getSelection();this.savedSel=[],this.savedSelObj=[],this.savedSel[0]=i.anchorNode,this.savedSel[1]=i.anchorOffset,this.savedSelObj[0]=i.focusNode,this.savedSelObj[1]=i.focusOffset}},restoreSelection:function(){null!==this.savedSel&&null!==this.savedSelObj&&"BODY"!==this.savedSel[0].tagName?window.Selection.setSelection(window,this.savedSel[0],this.savedSel[1],this.savedSelObj[0],this.savedSelObj[1]):this.$editor.focus()},getParentNode:function(){try{if("undefined"!=typeof window.getSelection){var t=window.getSelection();return t.rangeCount>0?this.getSelection().getRangeAt(0).startContainer.parentNode:!1}if("undefined"!=typeof document.selection)return this.getSelection().parentElement()}catch(e){}},getCurrentNode:function(){try{if("undefined"!=typeof window.getSelection)return this.getSelection().getRangeAt(0).startContainer;if("undefined"!=typeof document.selection)return this.getSelection()}catch(t){}},setFocusNode:function(t){if("undefined"==typeof t)return!1;try{var e=document.createRange(),i=this.getSelection();null!==i&&(e.selectNodeContents(t),i.addRange(e),i.collapse(t,0)),this.$editor.focus()}catch(n){}},insertNodeAtCaret:function(t){if(window.getSelection){var e=this.getSelection();if(e.rangeCount){var i=e.getRangeAt(0);i.collapse(!1),i.insertNode(t),i=i.cloneRange(),i.selectNodeContents(t),i.collapse(!1),e.removeAllRanges(),e.addRange(i)}}else if(document.selection){var n=1===t.nodeType?t.outerHTML:t.data,r="marker_"+(""+Math.random()).slice(2);n+='<span id="'+r+'"></span>';var o=this.getSelection();o.collapse(!1),o.pasteHTML(n);var a=document.getElementById(r);o.moveToElementText(a),o.select(),a.parentNode.removeChild(a)}},getSelectedHtml:function(){var t="";if(window.getSelection){var e=window.getSelection();if(e.rangeCount){for(var i=document.createElement("div"),n=0,r=e.rangeCount;r>n;++n)i.appendChild(e.getRangeAt(n).cloneContents());t=i.innerHTML}}else document.selection&&"Text"===document.selection.type&&(t=document.selection.createRange().htmlText);return t},cleanStyleAttr:function(){this.$editor.on("DOMNodeInserted",t.proxy(function(e){if(t(e.target).attr("style"))for(var i=t(e.target).attr("style").split(";"),n=0;n<i.length;n++)if(i[n]){var r=i[n].split(":");this.compareParentStyles(t(e.target),r[0])}if(t(e.target).attr("style")&&0==t(e.target).attr("style").length&&t(e.target).removeAttr("style"),this.setInlineAttributes(e),this.opts.mixedDirectionSupport){var o=t(e.target),a=o.text();if(o.is("p,div:not(.redactor_editor),blockquote,ul,ol")){var s=this.findDirection(a);s==this.opts.direction?o.removeAttr("dir"):s&&o.attr("dir",s)}}},this))},setInlineAttributes:function(e){var i=t(e.target),n=i.attr("inline-styles"),r=i.attr("style"),o=this;if(n){var a=o.convertStylesToHash(n),s=o.convertStylesToHash(r);r+=" "+n;var l=t.extend(a,s);i.attr("style",o.convertHashToStyle(l)),i.removeAttr("inline-styles")}},convertHashToStyle:function(e){var i="";
return t.each(e,function(t,n){i+=t+": "+e[t]+"; "}),i},convertStylesToHash:function(e){var i=e.split(/;/),n={};return t.each(i,function(t,e){var i=e.split(/:/),r=(i[0]||"").replace(/^\s+|\s+$/g,""),o=(i[1]||"").replace(/^\s+|\s+$/g,"");r&&""!=r&&(n[r]=o)}),n},submitCleanup:function(){var e=this.$editor.closest("form");t(e).on("submit",t.proxy(function(){},this))},getBtn:function(e){return t(this.$toolbar.find("a.redactor_btn_"+e))},setBtnActive:function(t){this.getBtn(t).addClass("act")},setBtnInactive:function(t){this.getBtn(t).removeClass("act")},inactiveAllButtons:function(){t.each(this.opts.activeButtons,t.proxy(function(t,e){this.setBtnInactive(e)},this))},resizeImage:function(e){var i,n,r=!1,o=!1,a=t(e).width()/t(e).height(),s=10,l=10;t(e).off(".redactor"),t(e).on({"mouseleave.redactor":function(){r=!1},"mousedown.redactor":function(a){a.preventDefault(),r=!0,o=!0,i=Math.round(a.pageX-t(e).eq(0).offset().left),n=Math.round(a.pageY-t(e).eq(0).offset().top)},"mouseup.redactor":t.proxy(function(t){r=!1,this.syncCode()},this),"click.redactor":t.proxy(function(t){o&&this.imageEdit(t)},this),"mousemove.redactor":function(c){if(r){o=!1;var u=(Math.round(c.pageX-t(this).eq(0).offset().left)-i,Math.round(c.pageY-t(this).eq(0).offset().top)-n),d=t(e).height(),h=parseInt(d,10)+u,p=h*a;p>s&&t(e).width(p),h>l&&(t(e).attr("height",h+"px"),t(e).attr("data-height",h)),i=Math.round(c.pageX-t(this).eq(0).offset().left),n=Math.round(c.pageY-t(this).eq(0).offset().top)}}})},toggleTableOptions:function(){t(".table_optional").toggle(0!=t(this.getCurrentNode()).parents("table").length)},showTable:function(){this.saveSelection(),this.modalInit(RLANG.table,"table",300,t.proxy(function(){t("#redactor_insert_table_btn").click(t.proxy(this.insertTable,this))},this),function(){t("#redactor_table_rows").focus()})},insertTable:function(){for(var e=t("#redactor_table_rows").val(),i=t("#redactor_table_columns").val(),n=t("<div></div>"),r=Math.floor(99999*Math.random()),o=t('<table id="table'+r+'" style="border-collapse:collapse; border:1px solid #afafaf;width:100%;" border="1" cellspacing="0" cellpadding="0"><tbody></tbody></table>'),a=0;e>a;a++){for(var s=t("<tr></tr>"),l=0;i>l;l++){var c=t("<td><br></td>");t(s).append(c)}t(o).append(s)}t(n).append(o);var u=t(n).html()+"<p></p>";this.restoreSelection(),this.execCommand("inserthtml",u),this.modalClose(),this.observeTables()},tableObserver:function(e){this.$table=t(e.target).parents("table"),this.$table_tr=this.$table.find("tr"),this.$table_td=this.$table.find("td"),this.$table_td.removeClass("current"),this.$tbody=t(e.target).parents("tbody"),this.$thead=t(this.$table).find("thead"),this.$current_td=t(e.target),this.$current_td.addClass("current"),this.$current_tr=t(e.target).parents("tr")},deleteTable:function(){t(this.$table).remove(),this.$table=!1,this.syncCode()},deleteRow:function(){t(this.$current_tr).remove(),this.syncCode()},deleteColumn:function(){var e=t(this.$current_td).get(0).cellIndex;t(this.$table).find("tr").each(function(){t(this).find("td").eq(e).remove()}),this.syncCode()},addHead:function(){if(0!==t(this.$table).find("thead").length)this.deleteHead();else{var e=t(this.$table).find("tr").first().clone();e.find("td").html("&nbsp;"),this.$thead=t("<thead></thead>"),this.$thead.append(e),t(this.$table).prepend(this.$thead),this.syncCode()}},deleteHead:function(){t(this.$thead).remove(),this.$thead=!1,this.syncCode()},insertRowAbove:function(){this.insertRow("before")},insertRowBelow:function(){this.insertRow("after")},insertColumnLeft:function(){this.insertColumn("before")},insertColumnRight:function(){this.insertColumn("after")},insertRow:function(e){var i=t(this.$current_tr).clone();i.find("td").html("&nbsp;"),"after"===e?t(this.$current_tr).after(i):t(this.$current_tr).before(i),this.syncCode()},insertColumn:function(e){var i=0;this.$current_td.addClass("current"),this.$current_tr.find("td").each(function(e,n){t(n).hasClass("current")&&(i=e)}),this.$table_tr.each(function(n,r){var o=t(r).find("td").eq(i),a=o.clone();a.html("&nbsp;"),"after"===e?t(o).after(a):t(o).before(a)}),this.syncCode()},showCodeEditor:function(e){this.saveSelection(),this.selectedEvent=e,this.modalInit(RLANG.codeEditor,"codeEditor",650,t.proxy(function(){t("#redactor_insert_code_btn").click(t.proxy(this.insertCode,this)),"PRE"==t(e.target)[0].tagName?(t("#redactorInsertCode_selector").find("option").each(function(i,n){t(this).val()==t(e.target).attr("data-code-brush")&&t(this).prop("selected","selected")}),t("#redactor_code_delete_btn").removeClass("hide"),t("#redactor_code_delete_btn").click(t.proxy(function(){this.deleteElement(t(e.target))},this))):t("#redactor_code_delete_btn").addClass("hide"),setTimeout(function(){void 0!=jQuery.fn.tabby?t("#redactor_insert_text_area").focus().tabby():t("#redactor_insert_text_area").focus()},200)},this))},insertCode:function(){this.restoreSelection();var e=t("#redactor_insert_text_area").val(),i=e.split(/\r|\r\n|\n/),n="";if(i.length>10&&(n="code-large"),t.browser.msie&&(parseInt(t.browser.version,10)<9||parseInt(t.browser.version,10)>10)){var r=t(this.selectedEvent.target);r.is("pre")?(r.attr("code-brush",t("#redactorInsertCode_selector").val()).text(e),r.toggleClass("code-large",""!=n&&null!=n)):this.appendCodeTag(e,n)}else{var o=t(this.getSelection().anchorNode).parent();if(o.is("pre")){var a=document.createRange();a.selectNode(o[0]),this.getSelection().removeAllRanges(),this.getSelection().addRange(a),this.appendCodeTag(e,n)}else this.appendCodeTag(e,n)}this.observeCode(),this.modalClose()},observeCode:function(){this.getBtn("codeEditor").get(0)&&(this.$editor.find("pre").each(t.proxy(function(e,i){t(i).attr("contenteditable",!1),t(i).off("click"),t(i).on("click",t.proxy(function(e){this.showCodeEditor(e),t.browser.msie&&parseInt(t.browser.version,10)<9?t("#redactor_insert_text_area").val(t(i).html().replace(/&lt;/g,"<").replace(/&gt;/g,">")):t("#redactor_insert_text_area").val(t(i).text())},this))},this)),this.syncCode())},buildLangSelector:function(){var e='<select id="redactorInsertCode_selector" name="highlight-brush-type" data-minimum-results-for-search="100" class="select2 input-medium">';t.each(codeEditor_lang,function(t,i){e+='<option value="'+t+'">'+i+"</option>"}),e+="</select>",RLANG.lang_selector=e},appendCodeTag:function(e,i){var n=t("<div />");n.append(t("<p />").html("&nbsp;")),n.append(t("<pre />").attr("rel","highlighter").attr("data-code-brush",t("#redactorInsertCode_selector").val()).addClass(i).text(e)),n.append(t("<p />").html("&nbsp;")),this.execCommand("inserthtml",n.html())},showVideo:function(){this.saveSelection(),this.modalInit(RLANG.video,"video",600,t.proxy(function(){t("#redactor_insert_video_btn").click(t.proxy(this.insertVideo,this)),t("#redactor_insert_video_area").focus()},this))},insertVideo:function(){var e=t("#redactor_insert_video_area").val();e=this.stripTags(e),this.restoreSelection(),this.execCommand("inserthtml",e),this.modalClose()},setDefaultSelection:function(){if(!this.getSelection().getRangeAt(0).commonAncestorContainer.isEqualNode(this.$editor.get(0))){var t=this.getSelection();t.removeAllRanges();var e=document.createRange();e.setStart(this.$editor.get(0),0),e.setEnd(this.$editor.get(0),0),t.addRange(e)}},insertExternal:function(e){this.$editor.focus(),this.setDefaultSelection();var i=t(this.stripTags(e)).get(0);this.execCommand("inserthtml",this.stripTags(e));var n=this.getSelection(),r=document.createRange();n.removeAllRanges(),this.$editor.find("iframe").each(function(){t(this).attr("src")==t(i).attr("src")&&(r.selectNode(t(this).get(0)),r.collapse(!1),n.addRange(r))}),this.syncCode()},imageEdit:function(e){var i=t(e.target),n=i.parent(),r=t.proxy(function(){t("#redactor_file_alt").val(i.attr("alt")),t("#redactor_image_edit_src").attr("href",i.attr("src")),t("#redactor_form_image_align").val(i.css("float")),"A"===t(n).get(0).tagName&&t("#redactor_file_link").val(t(n).attr("href")),t("#redactor_image_delete_btn").click(t.proxy(function(){this.deleteElement(i)},this)),t("#redactorSaveBtn").click(t.proxy(function(){this.imageSave(i)},this))},this);this.modalInit(RLANG.image,"image_edit",380,r)},deleteElement:function(e){t(e).remove(),this.modalClose(),this.syncCode()},imageSave:function(e){var i=t(e).parent();t(e).attr("alt",t("#redactor_file_alt").val());var n=t("#redactor_form_image_align").val();"left"===n?t(e).css({"float":"left",margin:"0 10px 10px 0"}):"right"===n?t(e).css({"float":"right",margin:"0 0 10px 10px"}):t(e).css({"float":"none",margin:"0"});var r=t.trim(t("#redactor_file_link").val());if(""!==r)if("A"!==t(i).get(0).tagName){var o=t("<a >").attr("href",r).html(this.outerHTML(e)).get(0).outerHTML;t(e).replaceWith(o)}else t(i).attr("href",r);else"A"===t(i).get(0).tagName&&t(i).replaceWith(this.outerHTML(e));this.modalClose(),this.observeImages(),this.syncCode()},showImage:function(){this.saveSelection();var e=t.proxy(function(){if(this.opts.imageGetJson!==!1?t.getJSON(this.opts.imageGetJson,t.proxy(function(e){var i={},n=0;t.each(e,t.proxy(function(t,e){"undefined"!=typeof e.folder&&(n++,i[e.folder]=n)},this));var r=!1;if(t.each(e,t.proxy(function(e,n){var o="";"undefined"!=typeof n.title&&(o=n.title);var a=0;t.isEmptyObject(i)||"undefined"==typeof n.folder||(a=i[n.folder],r===!1&&(r=".redactorfolder"+a));var s=t("<a />").addClass("redactor_image_element").css({backgroundImage:"url('"+n.thumb+"')"});s.attr({rel:n.image,title:o,href:"javascript:void(null);"}),t("#redactor_image_box").append(s),t(s).click(t.proxy(this.imageSetThumb,this))},this)),!t.isEmptyObject(i)){t(".redactorfolder").hide(),t(r).show();var o=function(e){t(".redactorfolder").hide(),t(".redactorfolder"+t(e.target).val()).show()},a=t('<select id="redactor_image_box_select">');t.each(i,function(e,i){a.append(t('<option value="'+i+'">'+e+"</option>"))}),t("#redactor_image_box").before(a),a.change(o)}},this)):t("#redactor_tabs a").eq(1).remove(),this.opts.imageUpload!==!1)t("#redactor_image_choose_help_text").hide(),this.opts.uploadCrossDomain===!1&&this.isMobile()===!1&&0!==t("#redactor_file").length&&t("#redactor_file").dragupload({url:this.opts.imageUpload,uploadFields:{_uniquekey:t.proxy(function(){return this.uniqueKey},this)},success:t.proxy(this.imageUploadCallback,this),error:t.proxy(this.imageUploadCallback,this),ondropCallback:t.proxy(this.insertLoadingAtCaret,this)}),this.uploadInit("redactor_file",{auto:!0,url:this.opts.imageUpload,success:t.proxy(this.imageUploadCallback,this)});else if(t(".redactor_tab").hide(),this.opts.imageGetJson===!1)t("#redactor_image_choose_help_text").hide(),t("#redactor_tabs").remove(),t("#redactor_tab3").show();else{var e=t("#redactor_tabs a");e.eq(0).remove(),e.eq(1).addClass("redactor_tabs_act"),t("#redactor_tab2").show()}t("#redactor_upload_btn").click(t.proxy(this.imageUploadCallbackLink,this))},this),i=t.proxy(function(){this.opts.imageUpload===!1&&this.opts.imageGetJson===!1?t("#redactor_file_link").focus():t("#redactor_upload_btn").hide()},this);this.modalInit(RLANG.image,"image",570,e,i,!0)},imageSetThumb:function(e){this._imageSet('<img src="'+t(e.target).attr("rel")+'" alt="'+t(e.target).attr("title")+'" />',!0)},imageUploadCallbackLink:function(){if(""!==t("#redactor_file_link").val()){var e=t("<img >").attr("src",t("#redactor_file_link").val()).get(0).outerHTML;this._imageSet(e,!0)}else this.modalClose()},imageUploadCallback:function(t){this._imageSet(t)},_imageSet:function(e,i){var n=!0;if(e!==!1){var r="",o="";if(i!==!0)if(e.isJSON()&&(o=t.parseJSON(e)),void 0!=o.filelink)r='<p><img src="'+o.filelink+'" class= "inline-image" data-id = "'+o.fileid+'" alt="image"  title="image"/></p>',this.$editor.find("#uploading_images_"+o.uniquekey).replaceWith(t(r)),this.syncCode(),0==this.$editor.find("img.image-loader").length&&("function"==typeof this.opts.imageLoadedCallback?this.opts.imageLoadedCallback(this):this.enableFormAfterLoadingImage());else{try{o.alert!==!1&&alert(JSON.parse(e).error||RLANG.invalid_image_file)}catch(a){alert(RLANG.invalid_image_file)}this.$editor.find("img.image-loader").remove(),"function"==typeof this.opts.imageLoadedCallback?this.opts.imageLoadedCallback(this):this.enableFormAfterLoadingImage(),n=!1}else r=e,this.modalClose(),this.restoreSelection(),InlineImagesValidator.link(r)&&this.execCommand("inserthtml",r);i!==!0&&"function"==typeof this.opts.imageUploadCallback&&this.opts.imageUploadCallback(this,o)}n&&this.observeImages()},showLink:function(){this.saveSelection();var e=t.proxy(function(){this.insert_link_node=!1;var e=this.getSelection(),i="",n="",r="";if(t.browser.msie){var o=this.getParentNode();"A"===o.nodeName?(this.insert_link_node=t(o),n=this.insert_link_node.text(),i=this.insert_link_node.attr("href"),r=this.insert_link_node.attr("target")):n=this.oldIE()?e.text:e.toString()}else e&&e.anchorNode&&"A"===e.anchorNode.parentNode.tagName?(i=t(e.anchorNode.parentNode).attr("href"),n=e.anchorNode.parentNode.text,r=e.anchorNode.parentNode.target,""===e.toString()&&(this.insert_link_node=e.anchorNode.parentNode)):n=e.toString();if(t(".redactor_link_text").val(n),i){var a=i.replace(window.location.href,"");0===i.search("mailto:")?(this.setModalTab(2),t("#redactor_tab_selected").val(2),t("#redactor_link_mailto").val(i.replace("mailto:",""))):0===a.search(/^#/gi)?(this.setModalTab(3),t("#redactor_tab_selected").val(3),t("#redactor_link_anchor").val(a.replace(/^#/gi,""))):t("#redactor_link_url").val(i)}"_blank"===r&&t("#redactor_link_blank").prop("checked",!0),t("#redactor_insert_link_btn").click(t.proxy(this.insertLink,this))},this),i=function(e){t("#redactor_link_url").focus()};this.opts.popover?this.popoverInit(RLANG.link,"link",350,e,i):this.modalInit(RLANG.link,"link",460,e,i)},insertLink:function(){var i=t("#redactor_tab_selected").val(),n="",r="",o="";"1"===i?(n=t("#redactor_link_url").val(),r=e(t("#redactor_link_url_text").val()),t("#redactor_link_blank").prop("checked")&&(o="_blank")):"2"===i?(n="mailto:"+t("#redactor_link_mailto").val(),r=e(t("#redactor_link_mailto_text").val())):"3"===i&&(n="#"+t("#redactor_link_anchor").val(),r=e(t("#redactor_link_anchor_text").val())),this._insertLink('<a href="'+n.replace(/"/g,"&quot;")+'" target="'+o+'">'+r+"</a>",t.trim(r),n,o)},_insertLink:function(e,i,n,r){this.restoreSelection(),""!==i&&(this.insert_link_node?(t(this.insert_link_node).text(i),t(this.insert_link_node).attr("href",n),""!==r&&t(this.insert_link_node).attr("target",r),this.syncCode()):this.insertOnCursorPosition("inserthtml",e)),this.modalClose()},showFile:function(){this.saveSelection();var e=t.proxy(function(){var e=this.getSelection(),i="";i=this.oldIE()?e.text:e.toString(),t("#redactor_filename").val(i),this.opts.uploadCrossDomain===!1&&this.isMobile()===!1&&t("#redactor_file").dragupload({url:this.opts.fileUpload,uploadFields:this.opts.uploadFields,success:t.proxy(function(t){this.fileUploadCallback(t)},this)}),this.uploadInit("redactor_file",{auto:!0,url:this.opts.fileUpload,success:t.proxy(function(t){this.fileUploadCallback(t)},this)})},this);this.modalInit(RLANG.file,"file",500,e)},fileUploadCallback:function(e){if(this.restoreSelection(),e!==!1){var i=t.parseJSON(e),n=t("#redactor_filename").val();""===n&&(n=i.filename);var r='<a href="'+i.filelink+'">'+n+"</a>";t.browser.webkit&&window.chrome&&(r+="&nbsp;"),this.execCommand("inserthtml",r),"function"==typeof this.opts.fileUploadCallback&&this.opts.fileUploadCallback(this,i)}this.modalClose()},popoverInit:function(e,i,n,r,o){0===t("#redactor_modal").length&&(this.popover=t('<div id="redactor_modal" style="display: none;"><span id="redactor_arrow_top"></span><div id="redactor_modal_inner"></div></div>'),t(".redactor_toolbar").after(this.popover)),this.hdlModalClose=t.proxy(function(t){27===t.keyCode&&this.modalClose()},this),t(document).keyup(this.hdlModalClose),this.$editor.keyup(this.hdlModalClose),t("#redactor_modal_inner").html(this.opts["modal_"+i]),this.opts.overlay&&t("#redactor_modal").show(),t("#redactor_btn_modal_close").click(t.proxy(this.modalClose,this)).css({marginRight:"5px"}),"function"==typeof r&&r(),t("#redactor_tabs").hide();t("#redactor_modal").outerHeight(!0);this.isMobile()===!1?(t("#redactor_modal").css({width:n+"px",height:"auto",minHeight:"auto",position:"absolute",left:"62px","box-shadow":"0 3px 5px #ccc",top:"30px"}).fadeIn("fast"),this.modalSaveBodyOveflow=this.modalSaveBodyOveflow||t(document.body).css("overflow"),t(document.body).css("overflow","hidden")):t("#redactor_modal").css({width:"100%",height:"100%",margin:"0",minHeight:"300px",position:"absolute",left:"62px","box-shadow":"0 3px 5px #ccc",top:"30px"}).show(),t(".redactor_tab input").css({"line-height":"23px",border:"1px solid #ccc","border-radius":"3px"}),t("#redactor_modal_footer").css({padding:0}),"function"==typeof o&&o()},modalInit:function(e,i,n,r,o){if(0===t("#redactor_modal_overlay").length&&(this.overlay=t('<div id="redactor_modal_overlay" style="display: none;"></div>'),t("body").prepend(this.overlay)),0===t("#redactor_modal").length&&(this.modal=t('<div id="redactor_modal" style="display: none;"><div id="redactor_modal_close">&times;</div><div id="redactor_modal_header"></div><div id="redactor_modal_inner"></div></div>'),t("body").append(this.modal)),t("#redactor_modal_close").click(t.proxy(this.modalClose,this)),this.hdlModalClose=t.proxy(function(t){27===t.keyCode&&this.modalClose()},this),t(document).keyup(this.hdlModalClose),this.$editor.keyup(this.hdlModalClose),t("#redactor_modal_inner").html(this.opts["modal_"+i]),t("#redactor_modal_header").html(e),this.opts.overlay&&(t("#redactor_modal_overlay").show(),0!=t("#redactor_modal form").data("overlayEvent")&&t("#redactor_modal_overlay").click(t.proxy(this.modalClose,this))),0!==t("#redactor_tabs").length){t("#redactor_tabs a").each(function(e,n){e++,t(n).click(function(){t("#redactor_tabs a").removeClass("redactor_tabs_act"),t(this).addClass("redactor_tabs_act"),t(".redactor_tab").slideUp("fast"),t("#redactor_tab"+e).slideDown("fast"),"image"==i&&2>=e?t("#redactor_upload_btn").hide():t("#redactor_upload_btn").show(),"image"==i&&2==e?t("#redactor_image_choose_help_text").show():t("#redactor_image_choose_help_text").hide(),t("#redactor_tab_selected").val(e)})})}t("#redactor_btn_modal_close").click(t.proxy(this.modalClose,this)),"function"==typeof r&&r();t("#redactor_modal").outerHeight(!0);this.isMobile()===!1?(t("#redactor_modal").css({position:"fixed",top:"50%",left:"50%",width:n+"px",height:"auto",minHeight:"auto",marginTop:"-255px",marginLeft:"-"+(n+60)/2+"px"}).fadeIn("fast"),this.modalSaveBodyOveflow=this.modalSaveBodyOveflow||t(document.body).css("overflow"),t(document.body).css("overflow","hidden")):t("#redactor_modal").css({position:"fixed",width:"100%",height:"100%",top:"0",left:"0",margin:"0",minHeight:"300px"}).show(),"function"==typeof o&&o()},modalClose:function(){t("#redactor_modal_close").unbind("click",this.modalClose),t("#redactor_modal").fadeOut("fast",t.proxy(function(){t("#redactor_modal_inner").html(""),this.opts.overlay&&(t("#redactor_modal_overlay").hide(),t("#redactor_modal_overlay").unbind("click",this.modalClose)),t(document).unbind("keyup",this.hdlModalClose),this.$editor.unbind("keyup",this.hdlModalClose)},this)),this.isMobile()===!1&&(t(document.body).css("overflow",this.modalSaveBodyOveflow),this.modalSaveBodyOveflow=null)},setModalTab:function(e){t(".redactor_tab").hide();var i=t("#redactor_tabs a");i.removeClass("redactor_tabs_act"),i.eq(e-1).addClass("redactor_tabs_act"),t("#redactor_tab"+e).show()},uploadInit:function(e,i){this.uploadOptions={url:!1,success:!1,start:!1,trigger:!1,auto:!1,input:!1},t.extend(this.uploadOptions,i),0!==t("#"+e).length&&"INPUT"===t("#"+e).get(0).tagName?(this.uploadOptions.input=t("#"+e),this.element=t(t("#"+e).get(0).form)):this.element=t("#"+e),this.element_action=this.element.attr("action"),this.uploadOptions.auto?t(this.uploadOptions.input).change(t.proxy(function(){var e=t(this.uploadOptions.input).get(0).files[0];InlineImagesValidator.fileValidator(e)&&(this.element.submit(function(t){return!1}),this.uploadSubmit())},this)):this.uploadOptions.trigger&&t("#"+this.uploadOptions.trigger).click(t.proxy(this.uploadSubmit,this))},uploadSubmit:function(){this.uploadForm(this.element,this.uploadFrame())},uploadFrame:function(){this.id="f"+Math.floor(99999*Math.random());var e=document.createElement("div"),i='<iframe style="display:none" id="'+this.id+'" name="'+this.id+'"></iframe>';e.innerHTML=i,document.body.appendChild(e),this.uploadOptions.start&&this.uploadOptions.start();var n=this;return t("#"+this.id).load(function(){n.uploadLoaded.call(n,this)}),this.id},uploadForm:function(e,i){if(this.insertLoadingAtCaret(),this.uploadOptions.input){var n="redactorUploadForm"+this.id,r="redactorUploadFile"+this.id;this.form=t('<form  action="'+this.uploadOptions.url+'" method="POST" target="'+i+'" name="'+n+'" id="'+n+'" enctype="multipart/form-data"></form>'),this.opts.uploadFields!==!1&&"object"==typeof this.opts.uploadFields&&t.each(this.opts.uploadFields,t.proxy(function(e,i){0===i.indexOf("#")&&(i=t(i).val());var n=t('<input type="hidden" name="'+e+'" value="'+i+'">');t(this.form).append(n)},this));var o=this.uploadOptions.input,a=t(o).clone(),s=t('<input type="hidden" name="_uniquekey" value="'+this.uniqueKey+'">');t(o).attr("id",r),t(o).before(a),t(o).appendTo(this.form),s.appendTo(this.form),t(this.form).css("position","absolute"),t(this.form).css("top","-2000px"),t(this.form).css("left","-2000px"),t(this.form).appendTo("body"),add_csrf_token(this.form),this.form.submit()}else e.attr("target",i),e.attr("method","POST"),e.attr("enctype","multipart/form-data"),e.attr("action",this.uploadOptions.url),add_csrf_token(e),this.element.submit()},insertLoadingAtCaret:function(){this.modalClose(),this.$editor.focus(),this.restoreSelection(),this.uniqueKey=(new Date).getTime(),this.focusOnCursor();var e=t('<img src="'+uploaded_img_placeholder+'" class="image-loader" id="uploading_images_'+this.uniqueKey+'">');this.insertNodeAtCaret(e.get(0)),"function"==typeof this.opts.imageLoadingCallback?this.opts.imageLoadingCallback(this):this.disableFormWhileLoadingImage()},disableFormWhileLoadingImage:function(){this.$editor.parents("form").find('input[type="submit"]:not(:disabled), input[type="button"]:not(:disabled), button:not(:disabled)').addClass("load-disable").prop("disabled",!0)},enableFormAfterLoadingImage:function(){this.$editor.parents("form").find(".load-disable").prop("disabled",!1)},uploadLoaded:function(e){var i=t(e).contents().find("body").get(0);if(this.uploadOptions.success)if("undefined"!=typeof i){var n=i.innerHTML,r=n.match(/\{.*\}/)[0];this.uploadOptions.success(r)}else alert("Upload failed!"),this.$editor.find("img.image-loader").remove(),"function"==typeof this.opts.imageLoadedCallback?this.opts.imageLoadedCallback(this):this.enableFormAfterLoadingImage(),this.uploadOptions.success(!1);this.element.attr("action",this.element_action),this.element.attr("target","")},browser:function(t){var e=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return"version"==t?i[2]:"webkit"==t?"chrome"==i[1]||"webkit"==i[1]:i[1]==t},oldIE:function(){return t.browser.msie&&parseInt(t.browser.version,10)<9?!0:!1},outerHTML:function(e){return t("<p>").append(t(e).eq(0).clone()).html()},normalize:function(t){return parseInt(t.replace("px",""),10)},isMobile:function(t){return t===!0&&/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)?!0:/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)?!0:!1},cleanUpRedundant:function(){var e=this;t.each(this.$editor.find("[rel=tempredactor]"),function(){_element=t(this),t.each(["li","ol","ul","h1","h2","h3","h4","h5","h6"],function(){_element.text()==t.trim(_element.parent().text())&&_element.parent().is(this.toString())&&_element.parent().replaceWith(_element)}),t(this).css("font-weight","normal"),t(this).removeAttr("rel")}),t.each(this.$editor.find("span"),function(){"temp_redactor_font_size"==t(this).attr("rel")?(t(this).find("span").css("font-size",""),t(this).removeAttr("rel")):"temp_redactor_font_family"==t(this).attr("rel")&&(t(this).find("span").css("font-family",""),t(this).removeAttr("rel"))}),t.each(this.$editor.find("span"),function(){t(this).text()==t(this).parent().text()&&t(this).parent().is("span")&&(parentstyle=t(this).parent().attr("style"),childstyle=t(this).attr("style"),t(this).parent().attr("style",parentstyle+";"+childstyle),t(this).replaceWith(t(this).html()))}),t.each(this.$editor.find("span"),function(){var i=this;t.each(e.opts.spanCleanupProperties,function(t,n){e.compareParentStyles(i,n)}),(t(this).css("background-color")==t(this).parent().css("background-color")||t(this).css("background-color")==e.$editor.css("background-color")&&"transparent"==t(this).parent().css("background-color"))&&t(this).css("background-color","")}),this.syncCode()},inputEventAvailable:function(){return t.browser.webkit||t.browser.mozilla},compareParentStyles:function(e,i){i=t.trim(i),t.trim(t(e).css(i))==t.trim(t(e).parent().css(i))&&t(e).css(i,"")},placeCaretAtEnd:function(){var t=this.$editor.get(0);if(t.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var e=document.createRange();e.selectNodeContents(t),e.collapse(!1);var i=window.getSelection();i.removeAllRanges(),i.addRange(e)}else if("undefined"!=typeof document.body.createTextRange){var n=document.body.createTextRange();n.moveToElementText(t),n.collapse(!1),n.select()}},insertHtmlAtLast:function(t){this.placeCaretAtEnd(),this.insertHtml(t)}},t.fn.getEditor=function(){return this.data("redactor").$editor},t.fn.getCode=function(){return this.data("redactor").getCode()},t.fn.getText=function(){return this.data("redactor").$editor.text()},t.fn.getSelected=function(){return this.data("redactor").getSelectedHtml()},t.fn.setCode=function(t){this.data("redactor").setCode(t)},t.fn.insertHtml=function(t){this.data("redactor").insertHtml(t)},t.fn.destroyEditor=function(){this.data("redactor").destroy(),this.removeData("redactor")},t.fn.setFocus=function(){this.data("redactor").$editor.focus()},t.fn.clearRichText=function(){var t=this.data("redactor");t.setCode(t.paragraphy(""))},t.fn.execCommand=function(t,e){this.data("redactor").execCommand(t,e)},t.fn.insertExternal=function(t){this.data("redactor").insertExternal(t)}}(jQuery),function(t){"use strict";function e(t){this.$editor=t,this.$form=this.$editor.$el.get(0).form}t.fn.removeCursorImage=function(){return this.each(function(){var t=new e(this);t.init()})},e.prototype={init:function(){"undefined"!=typeof Helpdesk&&Helpdesk.can_bind_first?jQuery(this.$form).bindFirst("submit",t.proxy(this.remove,this)):jQuery(this.$form).on("submit",t.proxy(this.remove,this))},remove:function(){this.$editor.removeCursorImage()}}}(window.jQuery),function(t){"use strict";function e(e,i){this.opts=t.extend({quote_class:"q-marker",remove_quote_class:"remove-quote",hover_container_class:"wrap-quoted-remove",template:"<div class='wrap-marker'></div>",tooltip_text:I18n.t("show_quoted_text"),tooltip_remove_quote:I18n.t("common_js_translations.remove_quoted_text")},i),this.$redactor=e,this.$redactor.$quoted=this,this.$quoted_area=t(this.$redactor.$el.data("quotedTextarea")),this.$remove_quote_marker=t("<span class='ficon-cross fsize-15 tooltip hide "+this.opts.remove_quote_class+"' title='"+this.opts.tooltip_remove_quote+"' />"),this.$quote_marker=t("<span class='"+this.opts.quote_class+" tooltip' title='"+this.opts.tooltip_text+"' />"),this.$template=t(this.opts.template),this.$hover_container=t("<span class='"+this.opts.hover_container_class+"'></span>").append(this.$quote_marker),this.$form=this.$redactor.$el.get(0).form,this.$quote_added=!1,this.$remove_tooltip_flag=!1,this.$remove_quote_option=this.$redactor.$el.data("removeQuote")}t.fn.quotedtext=function(t){return this.each(function(){var i=new e(this,t);i.init()})},e.prototype={init:function(){this.$remove_quote_option&&(t(this.$redactor.$box).delegate("."+this.opts.remove_quote_class,"click.quotedtext",t.proxy(this.removeQuotedText,this)),this.$hover_container.append(this.$remove_quote_marker),t(this.$redactor.$box).delegate("."+this.opts.hover_container_class,"mouseenter.quotedtext mouseleave.quotedtext",t.proxy(this.toggleRemoveOption,this))),this.$template.append(this.$hover_container),this.$template.insertAfter(this.$redactor.$editor),this.checkQuotedText(),t(this.$form).on("submit.quotedtext",t.proxy(this.syncQuotedText,this)),t(this.$redactor.$box).delegate("."+this.opts.quote_class,"click.quotedtext",t.proxy(this.insertQuotedText,this))},toggleRemoveOption:function(){this.$remove_quote_marker.toggle()},removeQuotedText:function(){t(".twipsy").remove(),this.$remove_tooltip_flag=!0,this.$template.remove()},insertQuotedText:function(){if("content"in document.createElement("template")){var e=document.importNode(this.$quoted_area[0].content,!0);e=t("<div></div>").append(e).append("<p><br /></p>"),this.$redactor.$editor.append(e.text())}else this.$redactor.insertHtmlAtLast(this.$quoted_area.val()+"<p><br /></p>");this.$redactor.syncCode(),this.checkQuotedText()},checkQuotedText:function(){this.$quote_added=this.$redactor.$editor.find(".freshdesk_quote").get(0)?!0:!1,this.$template.toggle(!this.$quote_added)},syncQuotedText:function(){if(!this.$quote_added&&!this.$remove_tooltip_flag){var e;if("content"in document.createElement("template")){var e=document.importNode(this.$quoted_area[0].content,!0);e=t(e).text()}else e=this.$quoted_area.val();var i=this.$redactor.$el.val()+e;this.$redactor.$el.val(i)}},reset:function(){this.$remove_quote_option=!1,this.$quote_added=!1,this.$remove_tooltip_flag=!1},destroy:function(){this.$remove_quote_option=!1,this.$quote_added=!1,this.$remove_tooltip_flag=!1,this.$template.remove(),t(this.$form).off(".quotedtext"),t(this.$redactor.$box).off(".quotedtext")}}}(window.jQuery),/*
	Plugin Drag and drop Upload v1.0.2
	http://imperavi.com/
	Copyright 2012, Imperavi Inc.
*/
function(t){"use strict";function e(e,i){this.opts=t.extend({url:!1,success:!1,preview:!1,uploadFields:!1,text:RLANG.drop_file_here,atext:RLANG.or_choose},i),this.$el=t(e)}t.fn.dragupload=function(t){return this.each(function(){var i=new e(this,t);i.init()})},e.prototype={init:function(){if(!t.browser.msie){this.droparea=t('<div class="redactor_droparea"></div>'),this.dropareabox=t('<div class="redactor_dropareabox"><span class="drop-text">'+this.opts.text+"</span></div>"),this.droparea.append(this.dropareabox),this.$el.parent().after(this.droparea);var e=this.$el.parent().remove();this.dropareabox.children(".drop-text").before(e),this.dropareabox.bind("dragover",t.proxy(function(){return this.ondrag()},this)),this.dropareabox.bind("dragleave",t.proxy(function(){return this.ondragleave()},this)),this.dropareabox.get(0).ondrop=t.proxy(function(e){e.preventDefault(),this.opts.ondropCallback&&this.opts.ondropCallback(),this.dropareabox.removeClass("hover").addClass("drop");var i=e.dataTransfer.files[0];if(void 0!==i){var n=new FormData;if(this.opts.uploadFields!==!1&&"object"==typeof this.opts.uploadFields&&t.each(this.opts.uploadFields,t.proxy(function(e,i){"function"==typeof i?i=i():0===i.indexOf("#")&&(i=t(i).val()),n.append(e,i)},this)),!InlineImagesValidator.fileValidator(i))return this.opts.error('{"invalidFile": true,"alert":false}'),!0;n.append("image[uploaded_data]",i),t.ajax({dataType:"html",url:this.opts.url,data:n,cache:!1,contentType:!1,processData:!1,type:"POST",success:t.proxy(function(t){this.opts.success!==!1&&this.opts.success(t),this.opts.preview===!0&&this.dropareabox.html(t)},this),error:t.proxy(function(t){this.opts.error!==!1&&this.opts.error(t)},this)})}else this.opts.error('{"invalidFile": true}')},this)}},ondrag:function(){return this.dropareabox.addClass("hover"),!1},ondragleave:function(){return this.dropareabox.removeClass("hover"),!1}}}(jQuery),function(t){"use strict";t.fn.linkify=function(){}}(jQuery),function(t){"use strict";function e(t,e){this.$editor=e,this.upload_url=this.$editor.opts.clipboardImageUpload,this.currentevent=t}jQuery.event.props.push("dataTransfer"),t.fn.pasteImage=function(t){return this.each(function(){var i=new e(t,this);i.init()})},e.prototype={init:function(){this.bindCustomEvent(),"paste"==this.currentevent.type?this.pasteContent():this.dropedContent()},pasteContent:function(){var e,i,n,r,o=this,a=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);if(a)return this.currentevent.preventDefault(),!1;if(null!=(null!=(i=this.currentevent.originalEvent)?i.clipboardData:void 0))if(e=this.currentevent.originalEvent.clipboardData,e.items){var s=e.items,l=s[0].getAsFile();o.loadImageFileAsURL(l)}else this.$editor.saveSelection(),this.$editor.insertLoadingAtCaret(),t('[rel="getPasteImage"]').focus(),setTimeout(function(){var e=t("<div />").html(t('[rel="getPasteImage"]').html()),i=e.find("img")[0];t('[rel="getPasteImage"]').html(""),o.$editor.$el.trigger("pasteImage",{dataURI:i.src,uniqueKey:o.$editor.uniqueKey})},500);if(e=window.clipboardData){var c=e.files;for(n=0,r=c.length;r>n;n++){var u=c[n];o.loadImageFileAsURL(u),o.currentevent.preventDefault()}}},dropedContent:function(){var e=this.currentevent.originalEvent.dataTransfer.files,i=this;void 0!=e&&e.length>0&&(i.currentevent.preventDefault(),t.each(e,function(t,e){InlineImagesValidator.fileValidator(e)&&i.loadImageFileAsURL(e)}))},loadImageFileAsURL:function(t){var e=this,i=new FileReader;i.onload=function(t){e.handleImage(t.target.result)},i.readAsDataURL(t)},handleImage:function(t){this.$editor.saveSelection(),this.$editor.insertLoadingAtCaret(),this.currentevent.preventDefault(),this.$editor.$el.trigger("pasteImage",{dataURI:t,uniqueKey:this.$editor.uniqueKey})},bindCustomEvent:function(){var t=this;this.$editor.$el.off("pasteImage"),this.$editor.$el.on("pasteImage",function(e,i){t.saveImage(i),e.preventDefault()})},saveImage:function(e){var i=this.$editor,n={dataURI:e.dataURI,_uniquekey:e.uniqueKey};t.ajax({dataType:"json",url:this.upload_url,data:n,type:"POST",success:t.proxy(function(t){t=JSON.stringify(t),i.imageUploadCallback(t)},this),error:t.proxy(function(t){console.log(t),t=JSON.stringify(t),i.imageUploadCallback(t)},this)})}}}(window.jQuery),function(t){function e(){this.validType=["image/jpeg","image/png","image/tiff","image/tiff","image/gif"],this.validExtensions=["jpeg","jpg","png","tif","tiff","giff"]}e.prototype={fileValidator:function(t){return this.validType.indexOf(t.type)<0?!1:!0},cleanSvg:function(t){return t.replace(/<img(.*?)src="(.*?).svg(.*?)">/g,"")},link:function(t){return t.toLowerCase().indexOf(".svg")>-1?!1:!0}},InlineImagesValidator=new e}(window.jQuery),function(t){t.event.special.textselect={setup:function(e,i){t(this).data("textselected",!1),t(this).data("ttt",e),t(this).bind("mouseup",t.event.special.textselect.handler)},teardown:function(e){t(this).unbind("mouseup",t.event.special.textselect.handler)},handler:function(e){var i=t(this).data("ttt"),n=t.event.special.textselect.getSelectedText(i).toString();""!=n&&(t(this).data("textselected",!0),e.type="textselect",e.text=n,t.event.handle.apply(this,arguments))},getSelectedText:function(t){var e="";return window.getSelection?e=window.getSelection():document.getSelection?e=document.getSelection():document.selection&&(e=document.selection.createRange().text),e}},t.event.special.textunselect={setup:function(e,i){t(this).data("rttt",e),t(this).data("textselected",!1),t(this).bind("mouseup",t.event.special.textunselect.handler),t(this).bind("keyup",t.event.special.textunselect.handlerKey)},teardown:function(e){t(this).unbind("mouseup",t.event.special.textunselect.handler)},handler:function(e){if(t(this).data("textselected")){var i=t(this).data("rttt"),n=t.event.special.textselect.getSelectedText(i).toString();""==n&&(t(this).data("textselected",!1),e.type="textunselect",t.event.handle.apply(this,arguments))}},handlerKey:function(e){if(t(this).data("textselected")){var i=t(this).data("rttt"),n=t.event.special.textselect.getSelectedText(i).toString();(e.keyCode=27)&&""==n&&(t(this).data("textselected",!1),e.type="textunselect",t.event.handle.apply(this,arguments))}}}}(jQuery);var inlineImageUploadCallback=function(t,e){var i=t.$el.parents("form"),n=t.$el.attr("name").replace(/\[.*\]/g,""),r=jQuery('<input type="hidden">').attr({name:n+"[inline_attachment_ids][]",value:e.fileid,"class":"inline-attachment-input"});i.append(r)};